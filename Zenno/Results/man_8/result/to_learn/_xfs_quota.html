
<!--+++++++++++++++++++++++++++++++++++++++++++  0  +++++++++++++++++++++++++++++++++++++++++++--->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>Проект OpenNet: MAN xfs_quota (8) Команды системного администрирования (FreeBSD и Linux)</title><meta name="KeyWords" content="man, manual, MAN, системное руководство, linux, FreeBSD, OpenBSD, Solaris, ядро, программы, системный вызов, xfs_quota"><meta name="viewport" content="width=device-width, initial-scale=1"></head>


<body link="#0000FF" vlink="#000080" text="#000000" bgcolor="#E3E4D0" alink="#FF00FF">
<link rel="stylesheet" href="/opennet4.css" type="text/css">
<!--htdig_noindex-->
<form method="get" action="https://www.opennet.ru/search.shtml">
<aside>
<div style="width: 100%; text-align: right; font-size: 70%; background: #E9EAD6; margin-bottom:-10px;">
Профиль: <b><a href="/~" rel="nofollow" title="/~ - сводная страница участника"><u>Аноним</u></a></b> (<a href="https://www.opennet.ru/cgi-bin/openforum/vsluhboard.cgi?az=login">вход</a> | <a href="https://www.opennet.ru/cgi-bin/openforum/vsluhboard.cgi?az=user_register">регистрация</a>)</div>

<table cellspacing="0" cellpadding="0" width="100%" border="0">
<tbody><tr>
<td style="background: #E9EAD6 url('/back.gif') repeat-x bottom left" valign="BOTTOM" bgcolor="#E9EAD6" width="300">
<a href="https://www.opennet.ru/"><img src="/opennet2.gif" alt="The OpenNET Project" height="60" width="249" border="0"></a><br>
</td>
<td style="background: #E9EAD6 url('/back.gif') repeat-x bottom left" bgcolor="#E9EAD6" align="CENTER" width="100">

</td><td style="background: #E9EAD6 url('/back.gif') repeat-x bottom left;padding-bottom:10px;" bgcolor="#E9EAD6" align="CENTER" width="50%">
<table width="100%" border="0">
<tbody><tr>
<td width="22%">
 <a href="https://www.opennet.ru/opennews/" class="h"><b>НОВОСТИ</b></a> (<a href="https://www.opennet.ru/news/opennet.shtml" class="h">+</a>)
</td><td width="18%%">
  <a href="https://www.opennet.ru/mp/" class="h"><b>КОНТЕНТ</b></a>
</td><td width="14%">
  <a href="http://wiki.opennet.ru" class="h"><b>WIKI</b></a>
</td><td width="14%">
   <a href="https://www.opennet.ru/man.shtml" class="h"><b>MAN'ы</b></a>
</td><td width="16%">
   <a href="https://www.opennet.ru/forum/" class="h"><b>ФОРУМ</b></a>
</td><td width="16%">
<a href="https://www.opennet.ru/search.shtml" class="h" onmouseover="document.getElementById('form12').style.display='block';">Поиск</a>&nbsp;(<a href="https://www.opennet.ru/keywords/" class="h">теги</a>)
<input id="form12" style="display: none;" size="10" name="words" value="" title="для поиска в google наберите &quot;g фраза&quot;" type="text">
</td></tr>
</tbody></table>

</td><td style="background: #E9EAD6 url('/back.gif') repeat-x bottom left;padding-bottom:5px;" bgcolor="#E9EAD6" align="right" width="20%">

<a href="https://www.opennet.ru/opennews/opennews_all_utf.rss"><img src="/img/rss.png" alt="RSS" title="RSS" height="16" width="16" border="0"></a>&nbsp;<a href="https://twitter.com/opennetru"><img src="/twitter.png" alt="twitter" title="Twitter" height="16" width="16" border="0"></a>&nbsp;<a href="https://vk.com/opennet"><img src="/img/vkontakte.gif" title="ВКонтакте" height="16" width="16" border="0"></a>&nbsp;<a href="https://zen.yandex.ru/opennet"><img src="/img/zen.gif" title="Yandex Zen" height="16" width="16" border="0"></a>&nbsp;<a href="https://www.facebook.com/OpenNet.News/"><img src="/img/facebook.gif" title="Facebook" height="16" width="16" border="0"></a>&nbsp;<a href="https://telegram.space/opennet_ru"><img src="/img/telegram2.png" title="Telegram" height="16" width="16" border="0"></a>
</td></tr></tbody></table>
</aside>

<style>
    .hdr_mobile {
	text-align: center; 
	display: none;
	margin: 0px;
	padding: 0px;
    }
</style>
<div class="hdr_mobile">
<div style="margin-left: auto; margin-right: auto; width: 100%; height: 70px; border:1px solid #b0b190; min-width: 360px; max-width: 600px; background: #E9EAD6 url('/back.gif') repeat-x bottom left;">
<div style="float:left; width: 249px; height: 60px; margin-top: 10px;">
<a href="https://www.opennet.ru"><img src="/opennet2_lite.gif" style="height: 60px; width: 249px; border: 1px;" alt="The OpenNET Project / Index page"></a>
</div>
<div style="float: left; text-align: center; height: 70px; width: 331px; padding: 5px; margin-left: 10px;">
<br><small>[ <a href="/opennews/">новости</a>&nbsp;/<a href="/opennews/?full_lines=15&amp;lines=15&amp;mid_lines=00">+++</a> | <a href="/forum/">форум</a> | <a href="http://wiki.opennet.ru">wiki</a> | <a href="/keywords/">теги</a>
| <a href="tg://resolve?domain=opennet_ru"><img src="/img/telegram2.png" title="Telegram" style="margin-bottom: -4px;" height="16" width="16" border="0"></a>
]</small>
</div>
</div>
</div>
<div style="clear: both;"></div>


<div style="float: left; width: 279; text-align: left;padding-right: 60px;" id="adv">
</div>
<div style="padding-top: 0px;position:absolute;left:50%;margin-left:-235px;width:470px;" id="adv2">
</div>
<div style="width: 279;float: right;" id="adv3">
</div>
<div style="clear: both;"></div>
<br>
</form>
<!--/htdig_noindex-->

<center><h3><font color="#000088">Интерактивная система просмотра системных руководств (man-ов)</font></h3></center>
<form method="GET" action="/man.shtml"> 
<table cellspacing="0" cellpadding="1" bgcolor="#B0B190" align="center" width="600" border="0">
<tbody><tr>
<td valign="TOP">

<table cellspacing="0" cellpadding="0" bgcolor="#E9EAD6" align="center" width="100%" border="0">
<tbody><tr><td>&nbsp;<font color="#555555">Тема</font></td><td><font color="#555555">Набор</font></td><td><font color="#555555">Категория</font></td><td>&nbsp;</td></tr>
<tr><td>

&nbsp;<input size="20" name="topic" value="xfs_quota" type="text"></td><td><select name="russian">
<option value="4">Solaris man
</option><option value="1">FreeBSD man
</option><option value="3">Разные man
</option><option value="0" selected="">Русские man
</option><option value="2">Linux man
</option><option value="5">POSIX man
</option></select></td>
<td><select size="1" name="category">
	  <option value="" selected="">All
	  </option><option value="1">1
	  </option><option value="2">2
	  </option><option value="3">3
	  </option><option value="4">4
	  </option><option value="5">5
	  </option><option value="6">6
	  </option><option value="7">7
	  </option><option value="8">8
	  </option><option value="9">9
</option></select></td>

<td><input name="submit" value="Показать man" type="submit"></td></tr>
<script async="" src="https://www.google-analytics.com/analytics.js"></script><script language="JavaScript" src="/print.js"></script>
<tr><td colspan="4" align="left">&nbsp;[<a href="/man.shtml">Cписок руководств</a> | <a href="#" onclick="pr('none');">Печать</a>]</td></tr>
</tbody></table>
</td></tr></tbody></table>
</form>
<h3></h3><font size="+2">xfs_quota (8)</font><hr><li>&gt;&gt; <a href="/man.shtml?topic=xfs_quota&amp;category=8&amp;russian=0"><u>xfs_quota</u></a> (8) <font color="#555555"> ( Русские man: Команды системного администрирования )</font></li>
<a name="lbAB">&nbsp;</a>
<h2>ИМЯ</h2>

xfs_quota - управление использованием квот на файловых системах XFS
<a name="lbAC">&nbsp;</a>
<h2>ОБЗОР</h2>

<b>xfs_quota</b>

[
<b>-x</b>

] [
<b>-p</b>

<i>программа</i>

] [
<b>-c</b>

<i>команда(ы)</i>

] ... [
<b>-d</b>

<i>проект</i>

] ... [
<i>путь</i> ... ]

<a name="lbAD">&nbsp;</a>
<h2>ОПИСАНИЕ</h2>

<b>xfs_quota</b>

это утилита для предоставления информации и редактирования различных аспектов квот файловой системы.
<p>

Опциями
<b>xfs_quota</b>

являются:
</p><dl compact="">
<dt><b>-c</b><i> команда(ы)</i>

</dt><dd>
команды
<b>xfs_quota</b>

можно запускать в интерактивном режиме (по умолчанию) или как аргументы в командной строке. 
Может быть несколько
<b>-c</b>

аргументов.
Команды выполняются в указанной последовательности, затем программа завершает работу.
</dd><dt><b>-p</b><i> программа</i>

</dt><dd>
Указать имя программы для приглашений и некоторых сообщений
об ошибках, значение по умолчанию  
<b>xfs_quota</b>.

</dd><dt><b>-x</b>

</dt><dd>
Включает режим эксперта.
Все административные команды (см. ниже раздел КОМАНДЫ АДМИНИСТРАТОРА)
которые позволяют измененять систему квот доступны только
в экспертном режиме.
</dd><dt><b>-d</b><i> проект</i>

</dt><dd>
Может быть указано имя проекта или его числовой идентификатор, эта опция
ограничивает действие отдельных
<b>xfs_quota</b>

команд указанным набором проектов. Несколько
<b>-d</b>

аргументов могут быть указаны.
</dd></dl>
<p>

Необязательный(е)
<i>path</i>

аргумент(ы) могут быть использованы для указания точек монтирования или файлов
устройств идентифицирующих файловые системы XFS. Воздействие отдельных команд
<b>xfs_quota</b>

будет ограничено указанным набором файловых систем.
</p><p>

Данное руководство состоит из двух разделов - в первом находится
информация для пользователей файловых системам, где включены квоты, и
<b>xfs_quota</b>

команды представляющие интерес для таких пользователей;
а затем идет информация по использованию квот и команд по изменению системы квот,
которая полезна только администраторам файловых систем XFS.
</p><p>

Имейте в виду, что из общих опций для указания типов квот
для почти всех команд описанных ниже, представляют интерес следующие
- квота пользователя
(<b>-u</b>),

групповая квота
(<b>-g</b>),

и/или квота на проект
(<b>-p</b>).

Кроме этого, некоторые команды предоставляют опции для работы
с "blocks used"
(<b>-b</b>),

"inodes used"
(<b>-i</b>),

и/или "realtime blocks used"
(<b>-r</b>).

</p><p>

Также многие команды имеют обширную встроенную помощь.
Используйте команду
<b>help</b>

для получения более подробной информации по любой команде.
<a name="lbAE">&nbsp;</a>
</p><h2>ОБЗОР СИСТЕМЫ КВОТ</h2>

<p>

В большинстве вычислительных сред, дисковое пространство не является бесконечным.
Подсистема квот предоставляет механизм для контроля использования дискового
пространства.
Квоты могут быть установлены для каждого отдельного пользователя
на любых/всех локальных файловых системах.
Подсистема квот предупреждает пользователей,
когда они превышают выделенный им лимит, но дает некоторое дополнительное
пространство для текущей работы (жесткий-hard лимит/мягкий-soft лимит).
Кроме того, файловые системы XFS с выключенным механизмом ограничения по лимитам
могут быть использованы в качестве эффективной системы учета использования дискового
пространства.
<a name="lbAF">&nbsp;</a>
</p><h3>Пользовательский взгляд на дисковые квоты</h3>

Для большинства пользователей дисковые квоты не являются поводом для беспокойства
или событием, которое нельзя обойти. 
Существуют две возможные квоты, которые могут быть применены - лимит
установленный на суммарное дисковое пространство,
которое пользователь может занять и лимит на количество файлов (inode)
которыми он может владеть.
<p>

Команда
<b>quota</b>

предоставляет информацию о квотах, которые были
установлены системным администратором и текущем использовании дискового
пространства.
</p><p>

Существуют четыре значения для каждого лимита:
текущее использование, мягкое (soft) ограничение (квота), жесткое (hard)
ограничение и лимит времени.
Мягкий (soft) лимит - это количество 1K-блоков (или файлов), которых пользователь,
как ожидается, не превысит. Жесткая (hard) квота не может быть превышена. 
Если пользователь достигает жесткого ограничения, то дальнейшие запросы
о выделении пространства (или попытки создать файл) завершаются
с ошибкой "Quota exceeded" (EDQUOT).
</p><p>

Когда пользователь превышает мягкий (soft) лимит, включается таймер.
Каждый раз, когда использование диска становится ниже мягкого (soft) лимита,
таймер отключается.
Если таймер срабатывает, то превышение любого лимита рассматривается как
превышение жесткого (hard) лимита и ресурсы для пользователя больше не выделяются.
Единственный способ преодолеть это состояние, быстро отключить механизм
ограничения по лимитам или увеличить лимиты,
или уменьшить использование диска ниже квоты.
Только суперпользователь (т.е. в достаточной степени привилегированный процесс)
может установить лимит времени и это будет сделано на базе файловой системы.
<a name="lbAG">&nbsp;</a>
</p><h3>Выживание, когда лимит квоты исчерпан</h3>

В большинстве случаев, единственный способ для пользователя спасти
положение из состояния превышения квоты состоит в том, чтобы прервать
любую деятельность на файловой системе, где лимит квоты исчерпан, удалить
достаточное количество файлов, чтобы снизить лимит обратно ниже квоты,
и повторить операцию в отказавшей программе.
<br>

Однако, если пользователь находится в редакторе и попытка записи привела
к ошибке из-за ситуации с квотой, то это неподходящее направление действий.
Весьма вероятно, что сначала будет попытка записать файл, усеченный относительно
своего предыдущего содержимого, поэтому, если редактор прерывает выполнение
без правильного сохранения файла, можно потерять не только последние изменения,
но, возможно, большинство и даже всё существующее содержимое.
<br>

Есть несколько возможных безопасных выходов для пользователей, оказавшихся
в такой ситуации.
Он может использовать команду редактора для выхода в командную оболочку (shell)
для исследования своего файлового пространства и удаления ненужных файлов.
<p>
Или используя
<b><a href="https://www.opennet.ru/cgi-bin/opennet/man.cgi?topic=sh&amp;category=1">sh</a></b>(1),

он может приостановить редактор, удалить некоторые файлы,
а затем возобновить работу в редакторе.
Третья возможность заключается в том, чтобы записать файл на какую-либо другую
файловую систему (возможно, в файл в
<i>/tmp</i>)

где пользовательская квота не была превышена.
Затем, после устранения проблемы с квотой, файл может быть перемещен обратно
в файловую систему, которой он принадлежит.
<a name="lbAH">&nbsp;</a>
</p><h2>КОМАНДЫ ПОЛЬЗОВАТЕЛЯ</h2>

<dl compact="">
<dt><b>print</b>

</dt><dd>
Напечатать список всех путей с устройствами/идентификаторами проектов.
Путь в список может попасть из нескольких мест - из командной строки,
таблицы монтирования, из файла
<i>/etc/projects.</i>

</dd><dt><b>df</b>

</dt><dd>
Смотри команду
<b>free</b>

</dd><dt>
<b>quota</b>

[
<b>-gpu</b>

] [
<b>-bir</b>

] [
<b>-hnNv</b>

] [
<b>-f</b>

<i>файл</i>

] [
<i>ID</i>

|
<i>имя</i>

] ...
</dt><dd>
Показывает индивидуальное текущее использование и лимиты для одного
<i>имени</i>

пользователя или числового
<i>ID</i>

пользователя.
Опция
<b>-h</b>

действует как в команде
<b><a href="https://www.opennet.ru/cgi-bin/opennet/man.cgi?topic=df&amp;category=1">df</a></b>(1)

- показывает отчет в "человеко-читаемом" формате.
Опция
<b>-n</b>

печатает числовые идентификаторы (ID), а не имена.
Опция
<b>-N</b>

не печатает заголовок.
Опция
<b>-v</b>

выдает больше информации.
Опция
<b>-f</b>

перенаправляет вывод в
<i>файл</i>

вместо стандартного потока вывода.
</dd><dt>
<b></b></dt><dd><b>free</b>

[
<b>-bir</b>

] [
<b>-hN</b>

] [
<b>-f</b>

<i>файл</i>

]
<br>

Выдает отчет по использованию файловой системы подобно команде
<b><a href="https://www.opennet.ru/cgi-bin/opennet/man.cgi?topic=df&amp;category=1">df</a></b>(1).

Может показать использование
<b>b</b>locks<b>(блоков),</b>

<b>i</b>node,

и/или
<b>r</b>ealtime

block space (пространство блоков в реальном времени),
а также показать сколько использовано, свободное место и сколько всего доступно.
Если используется квота на проект (project quota) (смотри ниже раздел КВОТА ДЕРЕВА КАТАЛОГОВ),
то показывается отчет об использовании для этих проектов (дерева каталогов).
Опция
<b>-h</b>

печатает отчет в "человеко-читаемом" формате. Опция
<b>-N</b>

опускает заголовок. Опция
<b>-f</b>

направляет вывод в
<i>файл</i>

вместо стандартного потока вывода.
</dd><dt>
<b>help</b>

[
<i>команда</i>

]
</dt><dd>
Интерактивная помощь для всех команд или для одной определённой
<i>команды</i>.

</dd><dt><b>quit</b>

</dt><dd>
Выход из
<b>xfs_quota.</b>

</dd><dt><b>q</b>

</dt><dd>
Смотри команду
<b>quit.</b>

</dd></dl>
<a name="lbAI">&nbsp;</a>
<h2>УПРАВЛЕНИЕ СИСТЕМОЙ КВОТ</h2>

Система квот XFS отличается от других файловых систем по целому ряду направлений.
Самое главное,- XFS считает информацию о квотах как метаданные самой файловой
системы и использует журналирование для обеспечения более
высокого уровня целостности.
При администрировании различия следующие :
<dl compact="">
<dt>1.</dt><dd>
Команда
<b>quotacheck</b>

никак не влияет на файловые системы XFS.
Первый раз система квот активизируется при включении (при монтировании разделов),
и XFS делает автоматический внутренний quotacheck; после этого
система квот будет всегда включена до тех пор, пока не будет отключена вручную.
</dd><dt>2.</dt><dd>
Файл(ы) для квот в корне файловой системы XFS не нужны.
</dd><dt>3.</dt><dd>
</dd><dd>XFS различает систему учета квот и механизм ограничения по лимитам.
Система учета квот должна быть включена во время монтирования файловой
системы XFS.
Тем не менее в любое время можно включить/выключить механизм ограничения
по лимитам.
Опция "quota" команды
<b>mount</b>

включает оба механизма: систему учета квот и
механизм ограничения.
Опция "uqnoenforce" может быть использована для включения
учета квот пользователя при отключенной системе ограничения по лимитам.
</dd><dt>4.</dt><dd>
Включение квот на корневой файловой системе несколько отличается от
описанного выше.
Для IRIX XFS, обратитесь к
<b><a href="https://www.opennet.ru/cgi-bin/opennet/man.cgi?1M+quotaon">quotaon</a></b>(1M).

Для Linux XFS, флаги монтирования должны быть переданы с загрузочным параметром ядра
"rootflags=".
</dd><dt>5.</dt><dd>
Полезно использовать команду
<b>state</b>

для контроля состояния подсистемы XFS квот на разных этапах - 
это может быть использовано, когда квоты включены,
а также для контроля за использованием пространства,
занимаемого самой системой квот.
</dd><dt>6.</dt><dd>
Есть механизм, встроенный в
<b>xfsdump</b>

который позволяет делать резервную копию информации о квотах
которая будет нужна для последующего восстановления,
если в этом возникнет необходимость.
</dd><dt>7.</dt><dd>
Значения квот не могут быть установлены до включения системы квот.
</dd><dt>8.</dt><dd>
Файловые системы XFS хранят квоты для учетной записи суперпользователя
(идентификатор пользователя равен нулю), и утилиты будут показывать
информацию о использованию суперпользователем файловой системы.
Однако лимиты никогда не будут применены к суперпользователю
(так же как не будут применены и к группе или проекту с нулевым ID).
</dd><dt>9.</dt><dd>
Файловые системы XFS выполняют система учета квот
вне зависимости имеет ли пользователь установленные лимиты или нет.
</dd><dt>10.</dt><dd>
XFS поддерживает концепцию квоты проекта (project quota),
которая может быть использована в форме квоты на дерево каталогов 
(т.е. ограничить дерево каталогов только возможностью использования
дискового пространства установленного размера на указанной
файловой системе, или просто следить как используется пространство,
или число индексных дескрипторов - inode в дереве).
</dd></dl>
<a name="lbAJ">&nbsp;</a>
<h2>КОМАНДЫ АДМИНИСТРАТОРА</h2>

<dl compact="">
<dt>
<b>path</b>

[
<i>N</i>

]
</dt><dd>
Список всех путей с идентификаторами устройств/проектов
или установка текущего пути в
<i>N</i>-ый

элемент списка.
<b>Текущий путь</b>

используется многими командами
описанными здесь, он определяет файловую систему на которую
направлено действие команды.
Путь в список может попадать из нескольких мест - из командной
строки, таблицы монтирования, из файла
<i>/etc/projects.</i>

</dd><dt>
<b>report</b>

[
<b>-gpu</b>

] [
<b>-bir</b>

] [
<b>-ahntLNU</b>

] [
<b>-f</b>

<i>файл</i>

]
</dt><dd>
Отчет с информацией по квотам файловой системы.
Показывает использование всех квот для файловой системы, для
указанного типа квоты
(<b>u</b>/<b>g</b>/<b>p</b>

и/или
<b>b</b>locks/<b>i</b>nodes/<b>r</b>ealtime).

В отчете по умолчанию один блок равен 1KB. Опция
<b>-h</b>

показывает отчет в "человеко-читаемом" формате, как
команда
<b><a href="https://www.opennet.ru/cgi-bin/opennet/man.cgi?topic=df&amp;category=1">df</a></b>(1).<b>Опция</b>

<b>-f</b>

направляет отчет в
<i>файл</i>

вместо стандартного потока вывода. Опция
<b>-a</b>

выдает отчет обо всех файловых системах. Опция
<b>-n</b>

печатает числовые ID номера, а не имена. Опции
<b>-L</b>

и
<b>-U</b>

указывают для отчета нижнюю и верхнюю границы ID. Опция
<b>-N</b>

не печатает заголовок. Опция
<b>-t</b>

выдает краткий отчет.
</dd><dt>
<b></b></dt><dd><b>state</b>

[
<b>-gpu</b>

] [
<b>-av</b>

] [
<b>-f</b>

<i>файл</i>

]
<br>

Показывает общую информацию о состоянии системы квот.
Это отчет о состоянии учета квот, применению квот и
степень использования метеданных о квотах в файловой системе.
Опция
<b>-f</b>

направляет отчет в
<i>файл</i>

вместо стандартного потока вывода. Опция
<b>-a</b>

выдает отчет обо всех файловых системах, а не только по текущему пути.
</dd><dt>
<b></b></dt><dd><b>limit</b>

[
<b>-gpu</b>

]
<b>bsoft=</b><i>N</i>

|
<b>bhard=</b><i>N</i>

|
<b>isoft=</b><i>N</i>

|
<b>ihard=</b><i>N</i>

|
<b>rtbsoft=</b><i>N</i>

|
<b>rtbhard=</b><i>N</i>

<b>-d</b>

|
<i>id</i>

|
<i>имя</i>

<br>

Установить квоту ограничивая блоки (bhard/bsoft), количество
inode (ihard/isoft) и/или лимит блоков реального времени (rtbhard/rtbsoft).
Опция
<b>-d</b>

(по умолчанию) может быть использована для установки значения по умолчанию
которое будет использоваться, в противном случае должно быть указано
конкретное
<i>имя</i>

<b>u</b>ser/<b>g</b>roup/<b>p</b>roject

или цифровой
<i>id</i>ентификатор.

</dd><dt>
<b>timer</b>

[
<b>-gpu</b>

] [
<b>-bir</b>

]
<i>значение</i>

</dt><dd>
Предоставляет возможность изменять задержку
по времени (timeout) перед применением ограничений по лимитам
(т.е. количество времени, которое может пройти прежде, чем мягкие лимиты
будут применяться как жесткие лимиты). Текущий таймаут
показывается по команде
<b>state.</b>

Значением аргумента может быть количество секунд или единиц времени
'minutes', 'hours', 'days' и 'weeks'. Также можно использовать
их сокращения 'm', 'h', 'd' и 'w'.
</dd><dt>
<b>warn</b>

[
<b>-gpu</b>

] [
<b>-bir</b>

]
<i>значение</i>

<b>-d</b>

|
<i>id</i>

|
<i>имя</i>

</dt><dd>
Разрешает посылать предупреждение о лимите квоты (т.е. предупреждение о
превышении лимита будет послано кому-нибудь указанное число раз)
которое будет рассмотрено и изменено. Опция
<b>-d</b>

(по умолчанию) используется, чтобы установить количество раз по умолчанию,
иначе должно быть указано
<i>имя</i>

<b>u</b>ser/<b>g</b>roup/<b>p</b>roject

или числовой идентификатор
<i>id</i>.

<b>Примечание: эта функция в настоящее время не реализована.</b>

</dd><dt><b>enable</b> [ <b>-gpu</b> ] [ <b>-v</b> ]

</dt><dd>
Ключи механизма ограничения по лимитам для файловой системы,
идентифицируемой по текущему пути.
Требуется, чтобы файловая система была смонтирована с включенной
квотой и система учета должна быть активной. Опция
<b>-v</b>

(подробно) показывает состояние по завершению операции.
</dd><dt><b>disable</b> [ <b>-gpu</b> ] [ <b>-v</b> ]

</dt><dd>
Выключение системы действия квот, оставляя учет квот активным. Опция
<b>-v</b>

(подробно) показывает состояние по завершению операции.
</dd><dt><b>off</b> [ <b>-gpu</b> ] [ <b>-v</b> ]

</dt><dd>
Постоянно действующее отключение квот для файловой системы,
идентифицируемой по текущему пути.
Включить квоты вновь можно только размонтированием и
монтированием раздела.
</dd><dt><b>remove</b> [ <b>-gpu</b> ] [ <b>-v</b> ]

</dt><dd>
Удалить всё выделенное пространство выделенное под метаданные для квот
для файловой системы идентифицируемой по текущему пути.
Квота не должна быть включена на этой файловой системе,
иначе будет сообщено об ошибке.
</dd><dt>
<b></b></dt><dd><b>dump</b>

[
<b>-gpu</b>

] [
<b>-f</b>

<i>файл</i>

]
<br>

Дамп информации о лимитах квот для утилит резервного копирования на
стандартный вывод (по умолчанию) или в
<i>файл</i>.

Разумеется только лимиты, не информация по использованию.
</dd><dt>
<b>restore</b>

[
<b>-gpu</b>

] [
<b>-f</b>

<i>файл</i>

]
</dt><dd>
Восстановить лимиты квот из резервной копии из
<i>файла</i>.

Файл должен быть создан в формате команды
<b>dump.</b>

</dd><dt>
<b></b></dt><dd><b>quot</b>

[
<b>-gpu</b>

] [
<b>-bir</b>

] [
<b>-acnv</b>

] [
<b>-f</b>

<i>файл</i>

]
<br>

Итоговая информация об использовании файловой системы
пользователем, группой или проектом.
Эта команда использует специальный "bulkstat" интерфейс к XFS для
быстрого сканирования всей файловой системы и отчёта по использованию.
Эта команда может быть выполнена даже если квоты не включены,
и будет просканирована вся файловая система
(это может занять много времени...). Опция
<b>-a</b>

отображает информацию по всем файловым системам. Опция
<b>-c</b>

показывает гистограмму вместо отчета. Опция
<b>-n</b>

печатает числовые номера, а не имена. Опция
<b>-v</b>

выводит больше информации. Опция
<b>-f</b>

выдает отчет в
<i>файл</i>

вместо стандартного потока вывода.
</dd><dt>
<b>project</b>

[
<b>-cCs</b>

<i>id</i>

|
<i>имя</i>

]
</dt><dd>
Команда без аргументов выводит список имен известных проектов и их идентификаторов
(основываясь на записях из файлов
<i>/etc/projects</i>

и
<i>/etc/projid</i>

). Опции
<b>-c</b>,

<b>-C</b>,

и
<b>-s</b>

включают механизм квоты дерева каталогов, что детально обсуждается ниже.
</dd></dl>
<a name="lbAK">&nbsp;</a>
<h2>КВОТА ДЕРЕВА КАТАЛОГОВ</h2>

Механизм квоты на проект в XFS может быть использован в виде
квоты на дерево каталогов, где указанный каталог и все нижележащие файлы
и подкаталоги (т.е. дерево) может быть ограничено подмножеством
свободного пространства на файловой системе.
<p>

Управляемое дерево должно быть сначала настроено с использованием опции
<b>-s</b>

в команде
<b>project.</b>

Указанное имя или идентификатор проекта должен совпадать с одним
или несколькими деревьями, определёнными в файле
<i>/etc/projects</i>,

и в этих деревьях будут рекурсивно промаркированы затронутые inodes  
как часть данного дерева.
Эта операция устанавливает inode признак и идентификатор проекта на
каждый файл в затронутом дереве.
После завершения этой операции, новые файлы создаваемые в дереве автоматически
учитываются на основании их идентификатора проекта.
Попытка создать жесткую ссылку на файл в дереве будет успешной только в том случае,
если идентификатор проекта соответствует идентификатору проекта для дерева.
Утилита
<b>xfs_io</b>

может быть использована для установки ID проекта для произвольного файла,
но это может быть сделано только привилегированным пользователем.
</p><p>

Предыдущие настройки дерева могут быть очищены от контроля квот на проект
путем использования опции
<b>project -C,</b>

которая рекурсивно по дереву очистит затронутые inodes от контроля квот на проект.
</p><p>

Наконец, опция
<b>project -c</b>

может использоваться для проверки того, является ли дерево настроенным,
если настройки дерева правильны, то сообщений не будет, в противном
случае будут сообщены пути для inodes которые не имеют корректного ID проекта
как у остального дерева, или inode признак не установлен.
<a name="lbAL">&nbsp;</a>
</p><h2>ФОРМАТЫ ФАЙЛОВ</h2>

Есть два файла, связанных с механизмом квоты на дерево каталогов, а именно
<i>/etc/projects</i>

и
<i>/etc/projid</i>.

Последний не является обязательным.
Файл
<i>/etc/projects</i>

обеспечивает отображение между числовыми идентификаторами проектов и
каталогами, которые являются корневыми для квот на дерево.
Формат файлов прост:
<pre>
# это комментарий
# ...
<dd>10:/export/cage
42:/var/log
</dd></pre>

<p>

Файл
<i>/etc/projid</i>

обеспечивает отображение между числовыми идентификаторами проектов и
простыми человеко-читаемыми именами (это похоже на связь между именами
пользователей и uids).
Это простой формат:
</p><pre>
# это комментарий
# ...
cage:10
logfiles:42
</pre>

<p>

Этот файл не обязателен, если идентификатор проекта не может быть
отображен в имя, то показывается только числовой идентификатор.
</p><p>

<a name="lbAM">&nbsp;</a>
</p><h2>ПРИМЕРЫ</h2>

Включить механизм ограничения квот на файловой системе XFS (ограничить
пользователя установленным размером дискового пространства).
<pre>
# mount -o uquota /dev/xvm/home /home
# xfs_quota -x -c 'limit bsoft=500m bhard=550m tanya' /home
# xfs_quota -x -c report /home
</pre>

<p>

Включить механизм квот на проект на файловой системе XFS (установить
ограничение в 1 гигабайт пространства на файлы в каталоге логов)
</p><pre>
# mount -o prjquota /dev/xvm/var /var
# echo 42:/var/log &gt;&gt; /etc/projects
# echo logfiles:42 &gt;&gt; /etc/projid
# xfs_quota -x -c 'project -s logfiles' /var
# xfs_quota -x -c 'limit -p bhard=1g logfiles' /var
</pre>

<a name="lbAN">&nbsp;</a>
<h2>ПРЕДУПРЕЖДЕНИЯ</h2>

В XFS реализована задержка распределения (еще известная как allocate-on-flush)
и это влияет на подсистему квот.
Квота подстчитывается только после того как блоки действительно выделены,
при этом возможно, что при буферизованной записи в файл информация по использованию
дискового пространства не обновляется немедленно.
Только когда данные действительно записаны на диск, либо через механизм ядра по сбросу
буферов или при ручной синхронизации по команде
<b><a href="https://www.opennet.ru/cgi-bin/opennet/man.cgi?topic=sync&amp;category=2">sync</a></b>(2),

отчет по использованию дискового пространства будет показывать, что на
самом деле записано.
<p>

Кроме того, механизм распределения в XFS всегда резервирует за собой максимальный
объем пространства, прежде чем приступать к распределению.
Если места недостаточно, например, по причине превышения лимита квоты, это может
привести к отказу в распределении хотя на диске есть достаточно места.
Таким образом, ограничение квот иногда происходит в ситуациях, когда пользователь
имеет квоту и результат некоторых операций все еще не превышает квоту и
есть операция запущенная своим курсом.
Эти дополнительные накладные расходы находятся, как правило, в диапазоне десятков блоков. 
</p><p>

Оба эти свойства являются неизбежными побочными эффектами действий XFS,
поэтому следует иметь это в виду при назначении лимита блоков.
<a name="lbAO">&nbsp;</a>
</p><h2>ОШИБКИ</h2>

Поддержка квот для файловых систем в режиме реального времени субтомов пока не реализована,
так же как и механизм предупреждений о превышении квоты. (утилита Linux
<b><a href="https://www.opennet.ru/cgi-bin/opennet/man.cgi?topic=warnquota&amp;category=8">warnquota</a></b>(8)

может быть использована для получения аналогичной функциональности на этой платформе).
<a name="lbAP">&nbsp;</a>
<h2>ФАЙЛЫ</h2>


<dl compact="">
<dt><i>/etc/projects</i>

</dt><dd>
Отображает числовые идентификаторы проектов в деревья каталогов.
</dd><dt><i>/etc/projid</i>

</dt><dd>
Отображает числовые идентификаторы проектов в имена проектов.

</dd></dl>
<a name="lbAQ">&nbsp;</a>
<h2>ДЛЯ IRIX СМОТРИТЕ ТАКЖЕ</h2>

<b><a href="https://www.opennet.ru/cgi-bin/opennet/man.cgi?1M+quotaon">quotaon</a></b>(1M),

<b><a href="https://www.opennet.ru/cgi-bin/opennet/man.cgi?topic=xfs&amp;category=4">xfs</a></b>(4).

<p>
<a name="lbAR">&nbsp;</a>
</p><h2>ДЛЯ LINUX СМОТРИТЕ ТАКЖЕ</h2>

<b><a href="https://www.opennet.ru/cgi-bin/opennet/man.cgi?topic=warnquota&amp;category=8">warnquota</a></b>(8),

<b><a href="https://www.opennet.ru/cgi-bin/opennet/man.cgi?topic=xfs&amp;category=5">xfs</a></b>(5).

<p>
<a name="lbAS">&nbsp;</a>
</p><h2>СМОТРИТЕ ТАКЖЕ</h2>

<b><a href="https://www.opennet.ru/cgi-bin/opennet/man.cgi?topic=df&amp;category=1">df</a></b>(1),

<b><a href="https://www.opennet.ru/cgi-bin/opennet/man.cgi?topic=mount&amp;category=1">mount</a></b>(1),

<b><a href="https://www.opennet.ru/cgi-bin/opennet/man.cgi?topic=sync&amp;category=2">sync</a></b>(2).

<p>
<a name="lbAT">&nbsp;</a>
</p><h2>ПЕРЕВОД</h2>

Перевёл с английского Юрий Тимофеев &lt;<a href="mailto:tim4dev@gmail.com">tim4dev@gmail.com</a>&gt; 2009
<p>
</p><p>

</p><hr>
<a name="index">&nbsp;</a><h2>Index</h2>
<dl>
<dt><a href="#lbAB">ИМЯ</a></dt><dd>
</dd><dt><a href="#lbAC">ОБЗОР</a></dt><dd>
</dd><dt><a href="#lbAD">ОПИСАНИЕ</a></dt><dd>
</dd><dt><a href="#lbAE">ОБЗОР СИСТЕМЫ КВОТ</a></dt><dd>
<dl>
<dt><a href="#lbAF">Пользовательский взгляд на дисковые квоты</a></dt><dd>
</dd><dt><a href="#lbAG">Выживание, когда лимит квоты исчерпан</a></dt><dd>
</dd></dl>
</dd><dt><a href="#lbAH">КОМАНДЫ ПОЛЬЗОВАТЕЛЯ</a></dt><dd>
</dd><dt><a href="#lbAI">УПРАВЛЕНИЕ СИСТЕМОЙ КВОТ</a></dt><dd>
</dd><dt><a href="#lbAJ">КОМАНДЫ АДМИНИСТРАТОРА</a></dt><dd>
</dd><dt><a href="#lbAK">КВОТА ДЕРЕВА КАТАЛОГОВ</a></dt><dd>
</dd><dt><a href="#lbAL">ФОРМАТЫ ФАЙЛОВ</a></dt><dd>
</dd><dt><a href="#lbAM">ПРИМЕРЫ</a></dt><dd>
</dd><dt><a href="#lbAN">ПРЕДУПРЕЖДЕНИЯ</a></dt><dd>
</dd><dt><a href="#lbAO">ОШИБКИ</a></dt><dd>
</dd><dt><a href="#lbAP">ФАЙЛЫ</a></dt><dd>
</dd><dt><a href="#lbAQ">ДЛЯ IRIX СМОТРИТЕ ТАКЖЕ</a></dt><dd>
</dd><dt><a href="#lbAR">ДЛЯ LINUX СМОТРИТЕ ТАКЖЕ</a></dt><dd>
</dd><dt><a href="#lbAS">СМОТРИТЕ ТАКЖЕ</a></dt><dd>
</dd><dt><a href="#lbAT">ПЕРЕВОД</a></dt><dd>
</dd></dl>
<hr>
<br>
<form method="get" action="/search.shtml">
<font size="-1">
<font color="#555555">Поиск по тексту MAN-ов:&nbsp;</font><input size="30" name="words" value="xfs_quota" type="text">
<input name="restrict" value="/man" type="hidden">
<input value="Найти" type="submit">
</font>
<input name="method" value="and" type="hidden">
<input name="format" value="builtin-long" type="hidden">
<input name="sort" value="score" type="hidden">
</form>
<br>
<!--htdig_noindex-->
<noindex>
<br>


</noindex>
<!--/htdig_noindex-->


<!-- footer -->
<!--htdig_noindex-->
<br><br>
<div style="background-color: #E9EAD6; width:100%; height: 61px;">
<div style="margin-right: 20px; float:left; line-height: 61px; vertical-align: middle; margin-left: 10px; font-size: 120%;">
Спонсоры:
</div>
<div style="float:left; height: 60px;  line-height: 60px; margin-left: 20px;">
<a style="align: middle;" target="_blank" href="https://inferno.name/"><img src="/img/inferno2.png" alt="Inferno Solutions" height="57" width="200"></a>
</div>
<div style="float:right; height: 60px;  line-height: 60px;  margin-left: 15px;">
<a style="align: middle;" target="_blank" href="http://hoster.ru/?utm_source=site&amp;utm_medium=banner&amp;utm_campaign=opennet"><img src="/img/dh143x60t.png" alt="Hosting by Hoster.ru" height="60" width="143"></a>
</div>
<div style="float:right;  height: 60px;  line-height: 60px; vertical-align: middle;font-size: 120%;">
Хостинг:
</div>

</div>

<div style="clear: both;"></div>


<br>
<table class="ttxt" style="border-top: 3px solid #C9CaB6;">
<tbody><tr><td width="35%">
<a href="/cgi-bin/opennet/bookmark.cgi">Закладки на сайте</a><br>
<a href="/cgi-bin/opennet/bookmark.cgi?submit=add" target="blank_">Проследить за страницей</a>
</td>
<td align="RIGHT" width="65%">
Created&nbsp;1996-2021&nbsp;by <b><a href="/contact.shtml" title="email maxim.chirkov@gmail.com">Maxim&nbsp;Chirkov</a></b><br>
<a href="https://www.opennet.ru/add.shtml">Добавить</a>, <a href="https://www.opennet.ru/donate.shtml" style="color: #C00000;">Поддержать</a>, <a href="https://www.opennet.ru/banners2.shtml">Вебмастеру</a>
</td>
</tr>
</tbody></table>
<br><br>


<!--/htdig_noindex-->
<!-- end of footer -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-123449-1', 'auto');
    ga('send', 'pageview');
</script>




</body>
<!---------------------------------------------  0  ---------------------------------------------->
