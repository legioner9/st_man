
<!--+++++++++++++++++++++++++++++++++++++++++++  0  +++++++++++++++++++++++++++++++++++++++++++--->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>Проект OpenNet: MAN vzctl (8) Команды системного администрирования (FreeBSD и Linux)</title><meta name="KeyWords" content="man, manual, MAN, системное руководство, linux, FreeBSD, OpenBSD, Solaris, ядро, программы, системный вызов, vzctl"><meta name="viewport" content="width=device-width, initial-scale=1"></head>


<body link="#0000FF" vlink="#000080" text="#000000" bgcolor="#E3E4D0" alink="#FF00FF">
<link rel="stylesheet" href="/opennet4.css" type="text/css">
<!--htdig_noindex-->
<form method="get" action="https://www.opennet.ru/search.shtml">
<aside>
<div style="width: 100%; text-align: right; font-size: 70%; background: #E9EAD6; margin-bottom:-10px;">
Профиль: <b><a href="/~" rel="nofollow" title="/~ - сводная страница участника"><u>Аноним</u></a></b> (<a href="https://www.opennet.ru/cgi-bin/openforum/vsluhboard.cgi?az=login">вход</a> | <a href="https://www.opennet.ru/cgi-bin/openforum/vsluhboard.cgi?az=user_register">регистрация</a>)</div>

<table cellspacing="0" cellpadding="0" width="100%" border="0">
<tbody><tr>
<td style="background: #E9EAD6 url('/back.gif') repeat-x bottom left" valign="BOTTOM" bgcolor="#E9EAD6" width="300">
<a href="https://www.opennet.ru/"><img src="/opennet2.gif" alt="The OpenNET Project" height="60" width="249" border="0"></a><br>
</td>
<td style="background: #E9EAD6 url('/back.gif') repeat-x bottom left" bgcolor="#E9EAD6" align="CENTER" width="100">

</td><td style="background: #E9EAD6 url('/back.gif') repeat-x bottom left;padding-bottom:10px;" bgcolor="#E9EAD6" align="CENTER" width="50%">
<table width="100%" border="0">
<tbody><tr>
<td width="22%">
 <a href="https://www.opennet.ru/opennews/" class="h"><b>НОВОСТИ</b></a> (<a href="https://www.opennet.ru/news/opennet.shtml" class="h">+</a>)
</td><td width="18%%">
  <a href="https://www.opennet.ru/mp/" class="h"><b>КОНТЕНТ</b></a>
</td><td width="14%">
  <a href="http://wiki.opennet.ru" class="h"><b>WIKI</b></a>
</td><td width="14%">
   <a href="https://www.opennet.ru/man.shtml" class="h"><b>MAN'ы</b></a>
</td><td width="16%">
   <a href="https://www.opennet.ru/forum/" class="h"><b>ФОРУМ</b></a>
</td><td width="16%">
<a href="https://www.opennet.ru/search.shtml" class="h" onmouseover="document.getElementById('form12').style.display='block';">Поиск</a>&nbsp;(<a href="https://www.opennet.ru/keywords/" class="h">теги</a>)
<input id="form12" style="display: none;" size="10" name="words" value="" title="для поиска в google наберите &quot;g фраза&quot;" type="text">
</td></tr>
</tbody></table>

</td><td style="background: #E9EAD6 url('/back.gif') repeat-x bottom left;padding-bottom:5px;" bgcolor="#E9EAD6" align="right" width="20%">

<a href="https://www.opennet.ru/opennews/opennews_all_utf.rss"><img src="/img/rss.png" alt="RSS" title="RSS" height="16" width="16" border="0"></a>&nbsp;<a href="https://twitter.com/opennetru"><img src="/twitter.png" alt="twitter" title="Twitter" height="16" width="16" border="0"></a>&nbsp;<a href="https://vk.com/opennet"><img src="/img/vkontakte.gif" title="ВКонтакте" height="16" width="16" border="0"></a>&nbsp;<a href="https://zen.yandex.ru/opennet"><img src="/img/zen.gif" title="Yandex Zen" height="16" width="16" border="0"></a>&nbsp;<a href="https://www.facebook.com/OpenNet.News/"><img src="/img/facebook.gif" title="Facebook" height="16" width="16" border="0"></a>&nbsp;<a href="https://telegram.space/opennet_ru"><img src="/img/telegram2.png" title="Telegram" height="16" width="16" border="0"></a>
</td></tr></tbody></table>
</aside>

<style>
    .hdr_mobile {
	text-align: center; 
	display: none;
	margin: 0px;
	padding: 0px;
    }
</style>
<div class="hdr_mobile">
<div style="margin-left: auto; margin-right: auto; width: 100%; height: 70px; border:1px solid #b0b190; min-width: 360px; max-width: 600px; background: #E9EAD6 url('/back.gif') repeat-x bottom left;">
<div style="float:left; width: 249px; height: 60px; margin-top: 10px;">
<a href="https://www.opennet.ru"><img src="/opennet2_lite.gif" style="height: 60px; width: 249px; border: 1px;" alt="The OpenNET Project / Index page"></a>
</div>
<div style="float: left; text-align: center; height: 70px; width: 331px; padding: 5px; margin-left: 10px;">
<br><small>[ <a href="/opennews/">новости</a>&nbsp;/<a href="/opennews/?full_lines=15&amp;lines=15&amp;mid_lines=00">+++</a> | <a href="/forum/">форум</a> | <a href="http://wiki.opennet.ru">wiki</a> | <a href="/keywords/">теги</a>
| <a href="tg://resolve?domain=opennet_ru"><img src="/img/telegram2.png" title="Telegram" style="margin-bottom: -4px;" height="16" width="16" border="0"></a>
]</small>
</div>
</div>
</div>
<div style="clear: both;"></div>


<div style="float: left; width: 279; text-align: left;padding-right: 60px;" id="adv">
</div>
<div style="padding-top: 0px;position:absolute;left:50%;margin-left:-235px;width:470px;" id="adv2">
</div>
<div style="width: 279;float: right;" id="adv3">
</div>
<div style="clear: both;"></div>
<br>
</form>
<!--/htdig_noindex-->

<center><h3><font color="#000088">Интерактивная система просмотра системных руководств (man-ов)</font></h3></center>
<form method="GET" action="/man.shtml"> 
<table cellspacing="0" cellpadding="1" bgcolor="#B0B190" align="center" width="600" border="0">
<tbody><tr>
<td valign="TOP">

<table cellspacing="0" cellpadding="0" bgcolor="#E9EAD6" align="center" width="100%" border="0">
<tbody><tr><td>&nbsp;<font color="#555555">Тема</font></td><td><font color="#555555">Набор</font></td><td><font color="#555555">Категория</font></td><td>&nbsp;</td></tr>
<tr><td>

&nbsp;<input size="20" name="topic" value="vzctl" type="text"></td><td><select name="russian">
<option value="4">Solaris man
</option><option value="1">FreeBSD man
</option><option value="3">Разные man
</option><option value="0" selected="">Русские man
</option><option value="2">Linux man
</option><option value="5">POSIX man
</option></select></td>
<td><select size="1" name="category">
	  <option value="" selected="">All
	  </option><option value="1">1
	  </option><option value="2">2
	  </option><option value="3">3
	  </option><option value="4">4
	  </option><option value="5">5
	  </option><option value="6">6
	  </option><option value="7">7
	  </option><option value="8">8
	  </option><option value="9">9
</option></select></td>

<td><input name="submit" value="Показать man" type="submit"></td></tr>
<script async="" src="https://www.google-analytics.com/analytics.js"></script><script language="JavaScript" src="/print.js"></script>
<tr><td colspan="4" align="left">&nbsp;[<a href="/man.shtml">Cписок руководств</a> | <a href="#" onclick="pr('none');">Печать</a>]</td></tr>
</tbody></table>
</td></tr></tbody></table>
</form>
<h3></h3><font size="+2">vzctl (8)</font><hr><li>&gt;&gt; <a href="/man.shtml?topic=vzctl&amp;category=8&amp;russian=0"><u>vzctl</u></a> (8) <font color="#555555"> ( Русские man: Команды системного администрирования )</font></li>
<a name="lbAB">&nbsp;</a>
<h2>ИМЯ</h2>

vzctl - менеджер виртуальных сред
<a name="lbAC">&nbsp;</a>
<h2>ОБЗОР</h2>

vzctl [<i>flags</i>] <b>create</b> <i>идентификатор-среды</i>
<b>--ostemplate</b> <i>имя</i>] [<b>--config</b> <i>имя</i>]
[<b>--private</b> <i>путь</i>] [<b>--root</b> <i>путь</i>] [<b>--ipadd</b> <i>адрес</i>] [<b>--hostname</b> <i>имя</i>]
<p>

vzctl [<i>flags</i>] <b>set</b> <i>идентификатор-среды</i> [<i>параметры</i>] [<b>--save</b>]
</p><p>

vzctl [<i>flags</i>] <b>destroy</b> | <b>mount</b> | <b>umount</b> |
<b>start</b> | <b>stop</b> | <b>restart</b> |
<b>status</b> | <b>enter</b> <i>идентификатор-среды</i>
</p><p>

vzctl [<i>flags</i>] <b>exec</b> | <b>exec2</b> <i>идентификатор-среды</i>
<i>команда</i> [<i>аргумент</i> ...]
</p><p>

vzctl <b>runscript</b> <i>идентификатор-среды</i> <i>сценарий</i>
</p><p>

vzctl <b>--help</b> | <b>--version</b>
<a name="lbAD">&nbsp;</a>
</p><h2>ОПИСАНИЕ</h2>

Утилита <b>vzctl</b> запускается на физическом компьютере (Hardware Node - HN)
и позволяет управлять виртуальными средами (Virtual Environment - VE).
<p>

Виртуальная среда идентифицируется либо по числовому <i>идентификатору-среды</i>, либо
по имени (см. ключ <b>--name</b>). Идентификаторы &lt;= 100 зарезервированы
для внутреннего использования OpenVZ.
<a name="lbAE">&nbsp;</a>
</p><h2>ОПЦИИ</h2>

<a name="lbAF">&nbsp;</a>
<h3>Флаги</h3>

Следующие флаги можно использовать практически с любыми другими ключами.
<dl compact="">
<dt><b>--quiet</b></dt><dd>
Не выводить сообщения на экран и в протокол.
</dd><dt><b>--verbose</b></dt><dd>
Выводить максимально подробные сообщения.
</dd></dl>
<a name="lbAG">&nbsp;</a>
<h3>Настройка параметров виртуальных сред</h3>

<dl compact="">
<dt><b>set</b> <i>идентификатор-среды</i> [<i>параметры</i>] [<b>--save</b>]</dt><dd>
Эта команда позволяет изменять различные параметры виртуальной среды с указанным идентификатором.
Флаг <b>--save</b> включает сохранение параметров в 
файле конфигурации виртуальной среды <b><a href="https://www.opennet.ru/cgi-bin/opennet/man.cgi?topic=vps.conf&amp;category=5">vps.conf</a></b>(5).
Если виртуальная среда запущена, изменения вступают в силу незамедлительно.
<p>
С командой <b>set</b> можно указывать следующие опции:
</p></dd><dt><b>Общие параметры</b></dt><dd>
</dd><dt><b>--onboot</b> <i>yes</i>|<i>no</i></dt><dd>
Запускать ли виртуальную среду при загрузке системы.
По умолчанию это не происходит и для изменения этого поведения укажите значение <i>yes</i>.
</dd><dt><b>--root</b> <i>путь</i></dt><dd>
Корневой каталог для данной виртуальной среды. По сути это
точка монтирования корневого каталога виртуальной среды.
В значении должна содержаться последовательность <i>$VEID</i>, 
которая будет заменена на идентификатор среды. Изменять
этот параметр не рекомендуется, вместо этого лучше внести изменения в глобальный файл конфигурации
<b><a href="https://www.opennet.ru/cgi-bin/opennet/man.cgi?topic=vz&amp;category=5">vz</a></b>(5).
</dd><dt><b>--userpasswd</b> <i>пользователь</i>:<i>пароль</i></dt><dd>
Задать пароль для данного пользователя в виртуальной среде.
Если пользователь не существует, он будет создан.
Этот параметр не влияет на файл конфигурации.
(следовательно указание <b>--save</b> не имеет смысла).
Вместо этого изменяются файлы <b></b>/etc/passwd и <b></b>/etc/shadow в виртуальной среде.
<p>
Если корневой каталог виртуальной среды не смонтирован, то он предварительно монтируется.
После внесения изменений в файлы выполняется размонтирование.
</p><p>
Данная опция требует, чтобы область виртуальной среды существовала заранее.
</p></dd><dt><b>--disabled</b> <i>yes</i>|<i>no</i></dt><dd>
Запретить запуск виртуальной среды. Для принудительного её запуска 
выполните <b>vzctl start</b> с опцией <b>--force</b>.
</dd><dt><b>--name</b> <i>имя</i></dt><dd>
Присвоить <i>имя</i> виртуальной среде. Его затем можно будет использовать
вместо <i>идентификатора</i>. Среде можно присвоить несколько имён.
</dd><dt><b>--setmode</b> <i>restart</i>|<i>ignore</i></dt><dd>
Перезапускать ли виртуальную среду после изменения параметров требующих этого.
</dd><dt><b>Параметры работы с сетью</b></dt><dd>
</dd><dt><b>--ipadd</b> <i>адрес</i></dt><dd>
Назначить IP-адрес виртуальной среде.
Среде можно назначить несколько адресов.
</dd><dt><b>--ipdel</b> <i>адрес</i> | <b>all</b></dt><dd>
Отменить назначение IP-адреса виртуальной среде.
Для отмены всех назначений адресов данной среде укажите 
<b>--ipdel all</b>.
</dd><dt><b>--hostname</b> <i>имя</i></dt><dd>
Задать имя хоста виртуальной среды. Оно записывается в соответствующий файл в самой среде, имя которого зависит от дистрибутива.
</dd><dt><b>--nameserver</b> <i>адрес</i></dt><dd>
IP-адрес сервера DNS, который должен использоваться виртуальной средой.
Несколько серверов DNS необходимо задавать одной командой, используя данную опцию несколько раз
Все IP-адреса серверов DNS, которые имелись в конфигурации до вызова команды, удаляются.
</dd><dt><b>--searchdomain</b> <i>имя</i></dt><dd>
Домены для поиска DNS. 
Несколько доменов необходимо задавать одной командой, используя данную опцию несколько раз
Все домены, которые имелись в конфигурации до вызова команды, удаляются.
</dd><dt><b>--netif_add</b> <i>интерфейс[</i>,<i>mac</i>,<i>интерфейс-хоста</i>,<i>mac-хоста]</i></dt><dd>
Добавить виртуальное устройство ethernet (veth) в виртуальную среду.
<i>интерфейс</i> - будущее имя устройства ethernet в среде,
<i>mac</i> - MAC-адрес,
<i>интерфейс-хоста</i> - имя устройства ethernet на хосте, 
<i>mac-хоста</i> - MAC-адрес там же.
Формат MAC-адресов: XX:XX:XX:XX:XX:XX.
Все параметры кроме <i>интерфейс</i> необязательны и генерируются автоматически если не указаны.
</dd><dt><b>Настройка интерфейса</b></dt><dd>
<p>
Следующие опции позволяют изменять параметры уже существующих интерфейсов
ethernet. Настраиваемый интерфейс указывается через
<b>--ifname</b> <i>имя</i>.
</p><p>
<br>&nbsp;<b>--mac</b>&nbsp;<i>XX:XX:XX:XX:XX:XX</i>&nbsp;-&nbsp;MAC-адрес&nbsp;интерфейса&nbsp;в&nbsp;виртуальной&nbsp;среде.
<br>&nbsp;<b>--host_ifname</b>&nbsp;<i>имя</i>&nbsp;-&nbsp;интерфейс&nbsp;в&nbsp;VE0.
<br>&nbsp;<b>--host_mac</b>&nbsp;<i>XX:XX:XX:XX:XX:XX</i>&nbsp;-&nbsp;MAC-адрес&nbsp;интерфейса&nbsp;в&nbsp;VE0.
</p></dd><dt><b>--netif_del</b> <i>устройство</i>|<b>all</b></dt><dd>
Удалить виртуальное устройство ethernet из среды.
Для удаления всех устройств укажите <b>all</b>.
</dd><dt><b>Ограничение использования ресурсов</b></dt><dd>
<p>
Следующие опции позволяют наложить ограничения на использование тех или иных ресурсов.
Каждая из них требует один или два аргумента.
Если указывается один аргумент, <b>vzctl</b> устанавливает строгое ограничение.
Если указываются два значения (через двоеточие),
первый считается нестрогим ограничением (барьером), а второй - строгим (лимитом).
</p><p>
Единицы - элементы, страницы и байты.
Размер страницы зависит от архитектуры, например на 
IA32 это 4096 байт.
</p><p>
Для всех параметров <b>set</b>, не
начинающихся на <b>num</b>, можно указывать приставки единиц.
Например, <b>vzctl set</b> <i>идентификатор-среды</i> <b>--privvmpages 5M:6M</b>
задаст нестрогое ограничение на максимальный общий размер частных виртуальных страниц памяти (<b>privvmpages</b>)
в 5 Мб и строгое - в 6 Мб.
</p><p>
Допустимые приставки:
<br>

<b>g</b>, <b>G</b> -- гигабайты.
<br>

<b>m</b>, <b>M</b> -- мегабайты.
<br>

<b>k</b>, <b>K</b> -- килобайты.
<br>

<b>p</b>, <b>P</b> -- страницы (4096 байт на x86).
</p><p>
</p></dd><dt><b>--numproc</b> <i>число</i>[:<i>число</i>]</dt><dd>
Ограничение на число процессов и потоков на уровне ядра.
Указание нестрогого ограничения не имеет смысла.
</dd><dt><b>--numtcpsock</b> <i>число</i>[:<i>число</i>]</dt><dd>
Ограничение на число сокетов TCP, а, следовательно, и на число
клиентов, которых может обслуживать сервер одновременно.
Указание нестрогого ограничения не имеет смысла.
</dd><dt><b>--numothersock</b> <i>число</i>[:<i>число</i>]</dt><dd>
Ограничение на число сокетов, отличных от сокетов TCP (т.е. локальных, UDP и прочих).
Указание нестрогого ограничения не имеет смысла.
</dd><dt><b>--vmguarpages</b> <i>число-страниц</i>[:<i>число-страниц</i>]</dt><dd>
Объём памяти, гарантированно доступный виртуальной среде. Нестрогое ограничение 
- это объём памяти который может быть выделен приложению.
Смысл строгого ограничения на данный момент не определён. Он должен быть установлен в 2147483647.
</dd><dt><b>--kmemsize</b> <i>число-байт</i>[:<i>число-байт</i>]</dt><dd>
Объём памяти доступной ядру. Этот параметр имеет отношение также к 
<b>--numproc</b>. Каждый процесс потребляет некоторую часть блока памяти ядра
<br>&nbsp;-&nbsp;как&nbsp;минимум&nbsp;16&nbsp;кб&nbsp;и&nbsp;обычно&nbsp;на&nbsp;уровне&nbsp;30-50&nbsp;кб.
Некоторым процессам требуется больше.
Между строгим и нестрогим ограничениями должен быть достаточный зазор,
иначе в некоторый момент времени ядру придётся удалять уже существующие 
процессы для выполнения строгого ограничения <b>kmemsize</b>.
</dd><dt><b>--tcpsndbuf</b> <i>число-байт</i>[:<i>число-байт</i>]</dt><dd>
Ограничение на объём памяти, занимаемой буферами отправки TCP.
Не должно быть меньше 64 кб, и разница между строгим и нестрогим 
ограничениями должна быть не меньше значения 
<b>numtcpsock</b> умноженного на 2,5 кб.
</dd><dt><b>--tcprcvbuf</b> <i>число-байт</i>[:<i>число-байт</i>]</dt><dd>
Ограничение на объём памяти, занимаемой буферами приёма TCP.
Не должно быть меньше 64 кб, и разница между строгим и нестрогим 
ограничениями должна быть не меньше значения 
<b>numtcpsock</b> умноженного на 2,5 кб.
</dd><dt><b>--othersockbuf</b> <i>число-байт</i>[:<i>число-байт</i>]</dt><dd>
Ограничение на объём памяти, занимаемой буферами отправки других сокетов.
Если процессам виртуальной среды требуется посылать
большие датаграммы, установите соответствующее нестрогое ограничение.
Увеличение строгого ограничения необходимо для повышение производительности
при работе через локальные (UNIX) сокеты.
</dd><dt><b>--dgramrcvbuf</b> <i>число-байт</i>[:<i>число-байт</i>]</dt><dd>
Ограничение на объём памяти занимаемой буферами приёма других сокетов.
Если процессам виртуальной среды требуется посылать
большие датаграммы, установите соответствующее нестрогое ограничение.
Указание нестрогого лимита не требуется.
</dd><dt><b>--oomguarpages</b> <i>число-страниц</i>[:<i>число-страниц</i>]</dt><dd>
Гарантированный предел для OOM kill (удаление одного процесса для освобождения памяти).
Под этим значением понимается общий объём оперативной памяти и раздела подкачки
используемой процессами среды.
Значение нестрогого ограничения является пределом "out-of-memory" (ситуация нехватки памяти).
Если текущее значение oomguarpages ниже указанного,
процессы определённо не будут удаляться по условию "out-of-memory".
Смысл строгого ограничения не определён и должен быть равен 2147483647.
</dd><dt><b>--lockedpages</b> <i>число-страниц</i>[:<i>число-страниц</i>]</dt><dd>
Ограничение на число страниц, получаемых функцией <b><a href="https://www.opennet.ru/cgi-bin/opennet/man.cgi?topic=mlock&amp;category=2">mlock</a></b>(2).
</dd><dt><b>--privvmpages</b> <i>число-страниц</i>[:<i>число-страниц</i>]</dt><dd>
Позволяет контролировать объём памяти, выделяемой приложениям.
Виртуальная среда действительно использующая общую страницу
(отмеченную как <b>MAP_SHARED</b>) "платит" за неё только частично
(в зависимости от общего количества сред, использующих данную страницу).
За теоретически частную страницу (отмеченную как <b>MAP_PRIVATE</b>)
виртуальная среда платит либо часть, либо полностью, если 
физические страницы, связанные с выделенным адресным пространством,
могут быть в оперативной памяти, разделе подкачки или вообще не существовать на данном этапе.
Ограничение, определяемое данным параметром, 
относится к общему объёму выделенной памяти.
Обратите внимание, что виртуальная среда необязательно сможет
запросить указанный объём памяти. Основной механизм контроля выделения памяти - 
<b>--vmguarpages</b>.
</dd><dt><b>--shmpages</b> <i>число-страниц</i>[:<i>число-страниц</i>]</dt><dd>
Ограничение на размер сегмента совместно используемой памяти IPC.
Указание нестрогого ограничения не имеет смысла.
</dd><dt><b>--numfile</b> <i>число</i>[:<i>число</i>]</dt><dd>
Ограничение на количество открываемых файлов.
Указание нестрогого ограничения не имеет смысла.
</dd><dt><b>--numflock</b> <i>число</i>[:<i>число</i>]</dt><dd>
Ограничение на число блокировок для файлов.
Необходимо наличие промежутка между нестрогим и строгим значениями.
</dd><dt><b>--numpty</b> <i>число</i>[:<i>число</i>]</dt><dd>
Число псевдо-терминалов. В OpenVZ каждая виртуальная среда может иметь не больше 255 терминалов.
(PTY). Указание нестрогого ограничения не имеет смысла.
</dd><dt><b>--numsiginfo</b> <i>число</i>[:<i>число</i>]</dt><dd>
Количество структур siginfo.
Указание нестрогого ограничения не имеет смысла.
</dd><dt><b>--dcachesize</b> <i>число-байт</i>[:<i>число-байт</i>]</dt><dd>
Ограничение на размер кэша файловой системы, в т.ч.
структур dentry (для каталогов) и inode (для файлов).
Позволяет отказывать приложениям заранее,
а не во время критических операций с файлами.
Необходимо наличие промежутка между нестрогим и строгим значениями.
</dd><dt><b>--numiptent</b> <i>число</i>[:<i>число</i>]</dt><dd>
Число записей iptables (netfilter). Указание нестрогого ограничения не имеет смысла.
</dd><dt><b>--physpages</b> <i>число-страниц</i>[:<i>число-страниц</i>]</dt><dd>
Используется только для статистики.
Показывает использование оперативной памяти данной средой.
Нестрогое ограничение должно быть равно 0, а строгое - в 2147483647.
</dd><dt><b>Параметры распределения процессорного времени</b></dt><dd>
<p>
Следующие параметры позволяют контролировать использование процессора
виртуальными средами.
</p></dd><dt><b>--cpuunits</b> <i>число</i></dt><dd>
Вес виртуальной среды. Положительное целое число, передаваемое планировщику центрального ядра.
Чем больше число, тем больше процессорного времени будет выделяться 
данной виртуальной среде. Максимальное значение - 500000, минимальное - 8.
Значение по умолчанию - 1000.
<p>
Вес VE0 (физической среды) также можно задавать
(<b>vzctl set 0 --cpuunits </b><i>число</i>). Обычно он задаётся сценарием initscript
(/etc/init.d/vz).
</p></dd><dt><b>--cpulimit</b> <i>число</i>[<b>%</b>]</dt><dd>
Ограничение на загрузку процессора виртуальной средой в процентах.
Если в компьютере имеется два процессора, то максимальное значение - 200%.
Значение по умолчанию - 0 (без ограничений).
<b>--cpus</b> <i>число</i>
устанавливает число процессов, доступных в виртуальной среде.
</dd><dt><b>Информирование о доступной памяти</b></dt><dd>
<p>
Этот параметр определяет содержание /proc/meminfo в виртуальной среде.
</p></dd><dt><b>--meminfo</b> <b>none</b></dt><dd>
Выводить /proc/meminfo физической системы.
</dd><dt><b>--meminfo</b> <b>режим</b>:<i>значение</i></dt><dd>
Задать выводимый общий объём памяти. Свободная память вычисляется в 
зависимости от выбранного режима.
<br>

Доступны следующие режимы:
<br>

<b>pages</b>:<i>значение</i> - задать общий объём памяти в страницах
<br>

<b>privvmpages</b>:<i>значение</i> - задать общий объём памяти как 
<b>privvmpages</b> * <i>значение</i>
<p>
Значение по умолчанию - <b>privvmpages:1</b>.
</p></dd><dt><b>Параметры касающиеся iptables</b></dt><dd>
</dd><dt></dt><dt><b>--iptables</b> <i>имя</i></dt><dd>
</dd><dd>
Запретить доступ к модулям iptables из виртуальной среды
(по умолчанию доступны все модули iptables загруженные в физической системе).
Список модулей:
<i>iptable_filter</i>, <i>iptable_mangle</i>, <i>ipt_limit</i>,
<i>ipt_multiport</i>, <i>ipt_tos</i>, <i>ipt_TOS</i>, <i>ipt_REJECT</i>,
<i>ipt_TCPMSS</i>, <i>ipt_tcpmss</i>, <i>ipt_ttl</i>, <i>ipt_LOG</i>,
<i>ipt_length</i>, <i>ip_conntrack</i>, <i>ip_conntrack_ftp</i>,
<i>ip_conntrack_irc</i>, <i>ipt_conntrack</i>, <i>ipt_state</i>,
<i>ipt_helper</i>, <i>iptable_nat</i>, <i>ip_nat_ftp</i>, <i>ip_nat_irc</i>,
<i>ipt_REDIRECT</i> <i>xt_mac</i>.
</dd><dt><b>Сетевые устройства</b></dt><dd>
</dd><dt><b>--netdev_add</b> <i>имя</i></dt><dd>
Переместить сетевое устройство из VE0 в указанную среду.
</dd><dt><b>--netdev_del</b> <i>имя</i></dt><dd>
Удалить сетевое устройство из указанной среды.
</dd><dt><b>Параметры квотирования дискового пространства</b></dt><dd>
</dd><dt><b>--diskspace</b> <i>число</i>[:<i>число</i>]</dt><dd>
Строгая и нестрогая квоты в блоках. Один блок на данный момент равен 1 кб.
Допустимы также приставки <b>G</b>, <b>M</b> и <b>K</b>
(см. <b>Ограничение использования ресурсов</b>).
</dd><dt><b>--diskinodes</b> <i>число</i>[:<i>число</i>]</dt><dd>
Строгая и нестрогая квоты в inode.
</dd><dt><b>--quotatime</b> <i>число-секунд</i></dt><dd>
Допустимый период злоупотребления дисковым пространством
(т.е. время когда превышена нестрогая квота - "период отсрочки").
</dd><dt><b>--quotaugidlimit</b> <i>число</i></dt><dd>
Максимальное число идентификаторов пользователей и групп в виртуальной среде 
для которых будет применяться квотирование в среде.
При значении <b>0</b> такое квотирование не будет выполняться вообще.
<p>
Если ранее данный параметр был установлен в <b>0</b>,
повторное его изменение во время работы среды не будет вступать в силу немедленно.
</p></dd><dt><b>Параметры монтирования</b></dt><dd>
</dd><dt><b>--noatime</b> <b>yes</b>|<b>no</b></dt><dd>
Отключить запись данных в времени доступа к inode (фактически - к файлам) на файловой системе.
</dd><dt><b>Системные возможности</b></dt><dd>
</dd><dt><b>--capability</b> <i>имя</i>:<b>on</b>|<b>off</b></dt><dd>
Включить/выключить системную возможность в виртуальной среде.
Для вступления изменений в силу необходим перезапуск среды.
Для виртуальных сред предусмотрена стандартная конфигурация системных возможностей,
и данный ключ позволяет изменять эту конфигурацию по принципу "логического И".
<p>
Имеются следующие системные возможности:
<b>chown</b>, <b>dac_override</b>, <b>dac_read_search</b>, <b>fowner</b>,
<b>fsetid</b>, <b>kill</b>, <b>setgid</b>, <b>setuid</b>,
<b>setpcap</b>, <b>linux_immutable</b>, <b>net_bind_service</b>,
<b>net_broadcast</b>, <b>net_admin</b>, <b>net_raw</b>,
<b>ipc_lock</b>, <b>ipc_owner</b>, <b>sys_module</b>, <b>sys_rawio</b>,
<b>sys_chroot</b>, <b>sys_ptrace</b>, <b>sys_pacct</b>,
<b>sys_admin</b>, <b>sys_boot</b>, <b>sys_nice</b>, <b>sys_resource</b>,
<b>sys_time</b>, <b>sys_tty_config</b>, <b>mknod</b>, <b>lease</b>,
<b>setveid</b>, <b>ve_admin</b>.
</p><p>
<b>ВНИМАНИЕ</b>: включение некоторых системных возможностей может 
отрицательно повлиять на защиту, поэтому не изменяйте конфигурацию, если вы не знаете точно что делаете.
Установка <b>setpcap:on</b> скорее всего приведёт к невозможности запуска среды.
</p></dd><dt><b>Доступ к устройствам</b></dt><dd>
</dd><dt><b>--devnodes</b> <i>устройство</i>:<b>r|w|rw|none</b></dt><dd>
Дать виртуальной среде доступ (<b>r</b> - чтение, <b>w</b> - запись, <b>rw</b> - чтение и запись, <b>none</b> - запретить доступ)
к устройству с адресом /dev/<i>устройство</i>.
Файл устройства в виртуальной среде создаётся автоматически.
</dd><dt><b>--devices</b> <b>b|c</b>:<i>главный-номер</i>:<i>дополнительный-номер</i>|<b>all</b>:[<b>r</b>|<b>w</b>|<b>rw</b>|<b>none</b>]</dt><dd>
Дать виртуальной среде доступ к блочному (<b>b</b>lock) или символьному (<b>c</b>haracter)
устройству с главным номером <i>главный-номер</i> вторым номером <i>дополнительный-номер</i>.
Файлы устройств необходимо создавать вручную.
</dd><dt><b>Компоненты</b></dt><dd>
</dd><dt><b>--features</b> <i>имя</i>:<b>on|off</b></dt><dd>
Включить или выключить функцию виртуальной среды.
Имеющиеся функции: <i>sysfs</i>, <i>nfs</i>.
</dd><dt><b>Применение параметров из файла конфигурации</b></dt><dd>
</dd><dt><b>--applyconfig</b> <i>имя</i></dt><dd>
Считать параметры виртуальной среды из образцового файла конфигурации
<tt></tt><b>/etc/vz/conf/ve-</b><i>имя</i><tt></tt><b>.conf-sample</b>, и
применить их. Если также указана опция --save, сохранить в файле конфигурации среды.
Изменения не затрагивают следующие параметры: <b>HOSTNAME</b>, <b>IP_ADDRESS</b>,
<b>OSTEMPLATE</b>, <b>VE_ROOT</b> и <b>VE_PRIVATE</b>.
</dd><dt><b>--applyconfig_map</b> <i>имя</i></dt><dd>
Применить параметры из группы <i>имя</i>.
Восстановить имя среды по переменной NAME в файле её конфигурации.
</dd><dt><b>Приоритет операций ввода-вывода</b></dt><dd>
</dd><dt><b>--ioprio</b> <i>приоритет</i></dt><dd>
Определить для среды приоритет ввода-вывода.
Допустимый диапазон - <b>0-7</b>.
Чем больше <i>приоритет</i>, тем больше времени для операций ввода-вывода выделяется среде.
Приоритет по умолчанию - <b>4</b>.
<p>
</p></dd></dl>
<a name="lbAH">&nbsp;</a>
<h3>Создание точек восстановления</h3>

<p>
OpenVZ позволяет полностью сохранять состояние работающей виртуальной среды
с возможностью последующего возврата к нему.
</p><dl compact="">
<dt><b>chkpnt</b> <i>идентификатор-среды</i> [<b>--dumpfile</b> <i>имя</i>]</dt><dd>
Сохранить полное состояние работающей среды в файл-дамп,
и остановить её. Если опция <b>--dumpfile</b> не указана, для файла дампа используется имя 
<b>/vz/dump/Dump.</b><i>идентификатор-среды</i>.
</dd><dt><b>restore</b> <i>идентификатор-среды</i> [<b>--dumpfile</b> <i>имя</i>]</dt><dd>
Восстановить виртуальную среду из дампа, созданного командой <b>chkpnt</b>.
</dd></dl>
<a name="lbAI">&nbsp;</a>
<h3>Управление виртуальными средами</h3>

<dl compact="">
<dt><b>create</b> <i>идентификатор-среды</i> [<b>--ostemplate</b> <i>имя</i>] [<b>--config</b> <i>имя</i>] [<b>--private</b> <i>путь</i>] [<b>--root</b> <i>путь</i>] [<b>--ipadd</b> <i>адрес</i>] [<b>--hostname</b> <i>имя</i>]</dt><dd>
Создать область для новой виртуальной среды.
Эту команду необходимо выполнить один раз до первого запуска среды.
<p>
Если опция <b>--config</b> указана, в файл конфигурации среды будут перенесены значения 
из файла образца
<tt></tt><b>/etc/vz/conf/ve-</b><i>имя</i><tt></tt><b>.conf-sample</b>.
Если файл конфигурации уже существует, он предварительно удаляется (автоматически).
</p><p>
Опция <b>--root</b> <i>путь</i> определяет каталог, который будет использоваться как 
корневой каталог в виртуальной среде (по умолчанию значение переменной <b>VE_ROOT</b> в 
файле <b><a href="https://www.opennet.ru/cgi-bin/opennet/man.cgi?topic=vz&amp;category=5">vz</a></b>(5)). <i>$VEID</i> в аргументе заменяется на числовой идентификатор среды.
</p><p>
Опция <b>--private</b> <i>путь</i> задаёт каталог, в котором должны храниться
файлы и каталоги, относящиеся к данной среде 
(по умолчанию - значение переменной <b>VE_PRIVATE</b> в файле <b><a href="https://www.opennet.ru/cgi-bin/opennet/man.cgi?topic=vz&amp;category=5">vz</a></b>(5)).
<i>$VEID</i> в аргументе заменяется на числовой идентификатор среды.
</p><p>
Опция <b>--ipadd</b> <i>адрес</i> позволяет назначить среде IP-адрес.
Возможно назначение нескольких адресов указанием данной опции несколько раз.
</p><p>
Для задания имени хоста для среды воспользуйтесь <b>--hostname</b> <i>имя</i>.
</p><p>
</p></dd><dt><b>destroy</b></dt><dd>
Удалить область среды - удалить все файлы каталоги и файлы конфигурации указанной среды.
</dd><dt><b>start</b> [<b>--wait</b>] [<b>--force</b>]</dt><dd>
Монтировать (если это необходимо) и запустить виртуальную среду.
Если опция <b>--wait</b> не указана, <b>vzctl</b> передаст управление оболочке
немедленно, иначе будет ожидать перехода среды в основной режим выполнения (runlevel).
<p>
Для запуска отключенной среды укажите <b>--force</b> (см. <b>--disabled</b>).
</p></dd><dt><b>stop</b></dt><dd>
Остановить и отмонтировать виртуальную среду.
</dd><dt><b>restart</b></dt><dd>
Перезапустить среду: остановить, если она работает, и запустить (снова).
</dd><dt><b>status</b></dt><dd>
Вывести информацию о состоянии среды.
Сведения выводятся в виде строки из нескольких значений через пробел.
Первое - слово <b>VEID</b>. Второе - числовой идентификатор среды.
Третье сообщает о существовании среды (<b>exist</b> или <b>deleted</b>).
Четвёртое - состояние файловой системы среды (<b>mounted</b> или <b>unmounted</b>).
Пятое - работает ли среда в данный момент (<b>running</b> или <b>down</b>).
<p>
Эта команда может быть полезна при написании сценариев.
</p></dd><dt><b>mount</b></dt><dd>
Монтировать частную область среды.
</dd><dt><b>umount</b></dt><dd>
Отмонтировать частную область среды.
Заметьте, что при выполнении команды <b>stop</b> размонтирование происходит автоматически.
</dd><dt><b>exec</b> <i>идентификатор-среды</i> <i>команда</i></dt><dd>
Запустить <i>команду</i> в среде. Переменные оболочки не задаются в виртуальной среде.
Обработка сигналов может быть отличной от стандартной.
Если <i>команда</i> указана как <b>-</b>,
то собственно команды считываются со стандартного ввода.
</dd><dt><b>exec2</b> <i>идентификатор-среды</i> <i>команда</i></dt><dd>
Аналогично <b>exec</b>, но код возврата совпадает с кодом возврата <i>команды</i>.
</dd><dt><b>runscript</b></dt><dd>
Выполнить указанный сценарий в среде. Если она не выполняется, то будет запущена автоматически.
</dd><dt><b>enter</b></dt><dd>
Войти в виртуальную среду. Это своеобразный чёрный вход для администратора физического компьютера.
</dd></dl>
<a name="lbAJ">&nbsp;</a>
<h3>Другие опции</h3>

<dl compact="">
<dt><b>--help</b></dt><dd>
Вывести краткое описание допустимый опций.
</dd><dt><b>--version</b></dt><dd>
Вывести версию <b>vzctl</b>.
</dd></dl>
<a name="lbAK">&nbsp;</a>
<h2>ДИАГНОСТИКА</h2>

Если при выполнении команды ошибок не возникло, программа возвращает 0.
<a name="lbAL">&nbsp;</a>
<h2>ПРИМЕРЫ</h2>

Создать и запустить виртуальную среду "basic", с идентификатором 1000, 
используя шаблон <i>altlinux</i> и IP-адрес 192.168.10.200:
<br>

<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tt>vzctl create 1000 --ostemplate altlinux --config vps.basic<br>
<br>

<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tt>vzctl set 1000 --ipadd 192.168.10.200 --save<br>
<br>

<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tt>vzctl start 1000<br>
<br>


Задать ограничения на число работающих процессов (80/100) и 
открытых терминалов PTY (16/20):
<br>

<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tt>vzctl set 1000 --numproc 80:100 -t 16:20 --save<br>


Выполнить команду <b>ls -la</b> в этой же среде:
<br>

<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tt>vzctl exec 1000 /bin/ls -la<br>


Выполнить команду оболочки, задействующую конвейеры, <b>ls -l / | sort</b>:
<br>

<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tt>vzctl exec 1000 'ls -l / | sort'<br>


Остановить среду:
<br>

<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tt>vzctl stop 1000<br>


Удалить среду:
<br>

<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tt>vzctl destroy 1000<br>

<a name="lbAM">&nbsp;</a>
<h2>ФАЙЛЫ</h2>



/etc/vz/vz.conf
<br>

/etc/vz/conf/veid.conf
<br>

/proc/vz/veinfo
<br>

/proc/vz/vzquota
<br>

/proc/user_beancounters
<br>

/proc/fairsched
<a name="lbAN">&nbsp;</a>
<h2>СМ. ТАКЖЕ</h2>

<b><a href="https://www.opennet.ru/cgi-bin/opennet/man.cgi?topic=vz.conf&amp;category=5">vz.conf</a></b>(5),

<b><a href="https://www.opennet.ru/cgi-bin/opennet/man.cgi?topic=vps.conf&amp;category=5">vps.conf</a></b>(5),

<b><a href="https://www.opennet.ru/cgi-bin/opennet/man.cgi?topic=vzquota&amp;category=8">vzquota</a></b>(8),

<a name="lbAO">&nbsp;</a>
<h2>АВТОРСКИЕ ПРАВА</h2>

Copyright (C) 2000-2007 SWsoft. Распространяется на условиях лицензии GNU GPL v2.
<a name="lbAP">&nbsp;</a>
<h2>ПЕРЕВОД</h2>

Николай Шафоростов &lt;<a href="mailto:shafff@ukr.net">shafff@ukr.net</a>&gt; 2007
<p>

</p><hr>
<a name="index">&nbsp;</a><h2>Index</h2>
<dl>
<dt><a href="#lbAB">ИМЯ</a></dt><dd>
</dd><dt><a href="#lbAC">ОБЗОР</a></dt><dd>
</dd><dt><a href="#lbAD">ОПИСАНИЕ</a></dt><dd>
</dd><dt><a href="#lbAE">ОПЦИИ</a></dt><dd>
<dl>
<dt><a href="#lbAF">Флаги</a></dt><dd>
</dd><dt><a href="#lbAG">Настройка параметров виртуальных сред</a></dt><dd>
</dd><dt><a href="#lbAH">Создание точек восстановления</a></dt><dd>
</dd><dt><a href="#lbAI">Управление виртуальными средами</a></dt><dd>
</dd><dt><a href="#lbAJ">Другие опции</a></dt><dd>
</dd></dl>
</dd><dt><a href="#lbAK">ДИАГНОСТИКА</a></dt><dd>
</dd><dt><a href="#lbAL">ПРИМЕРЫ</a></dt><dd>
</dd><dt><a href="#lbAM">ФАЙЛЫ</a></dt><dd>
</dd><dt><a href="#lbAN">СМ. ТАКЖЕ</a></dt><dd>
</dd><dt><a href="#lbAO">АВТОРСКИЕ ПРАВА</a></dt><dd>
</dd><dt><a href="#lbAP">ПЕРЕВОД</a></dt><dd>
</dd></dl>
<hr>
<br>
<form method="get" action="/search.shtml">
<font size="-1">
<font color="#555555">Поиск по тексту MAN-ов:&nbsp;</font><input size="30" name="words" value="vzctl" type="text">
<input name="restrict" value="/man" type="hidden">
<input value="Найти" type="submit">
</font>
<input name="method" value="and" type="hidden">
<input name="format" value="builtin-long" type="hidden">
<input name="sort" value="score" type="hidden">
</form>
<br>
<!--htdig_noindex-->
<noindex>
<br>


</noindex>
<!--/htdig_noindex-->


<!-- footer -->
<!--htdig_noindex-->
<br><br>
<div style="background-color: #E9EAD6; width:100%; height: 61px;">
<div style="margin-right: 20px; float:left; line-height: 61px; vertical-align: middle; margin-left: 10px; font-size: 120%;">
Спонсоры:
</div>
<div style="float:left; height: 60px;  line-height: 60px; margin-left: 20px;">
<a style="align: middle;" target="_blank" href="https://inferno.name/"><img src="/img/inferno2.png" alt="Inferno Solutions" height="57" width="200"></a>
</div>
<div style="float:right; height: 60px;  line-height: 60px;  margin-left: 15px;">
<a style="align: middle;" target="_blank" href="http://hoster.ru/?utm_source=site&amp;utm_medium=banner&amp;utm_campaign=opennet"><img src="/img/dh143x60t.png" alt="Hosting by Hoster.ru" height="60" width="143"></a>
</div>
<div style="float:right;  height: 60px;  line-height: 60px; vertical-align: middle;font-size: 120%;">
Хостинг:
</div>

</div>

<div style="clear: both;"></div>


<br>
<table class="ttxt" style="border-top: 3px solid #C9CaB6;">
<tbody><tr><td width="35%">
<a href="/cgi-bin/opennet/bookmark.cgi">Закладки на сайте</a><br>
<a href="/cgi-bin/opennet/bookmark.cgi?submit=add" target="blank_">Проследить за страницей</a>
</td>
<td align="RIGHT" width="65%">
Created&nbsp;1996-2021&nbsp;by <b><a href="/contact.shtml" title="email maxim.chirkov@gmail.com">Maxim&nbsp;Chirkov</a></b><br>
<a href="https://www.opennet.ru/add.shtml">Добавить</a>, <a href="https://www.opennet.ru/donate.shtml" style="color: #C00000;">Поддержать</a>, <a href="https://www.opennet.ru/banners2.shtml">Вебмастеру</a>
</td>
</tr>
</tbody></table>
<br><br>


<!--/htdig_noindex-->
<!-- end of footer -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-123449-1', 'auto');
    ga('send', 'pageview');
</script>




</body>
<!---------------------------------------------  0  ---------------------------------------------->
