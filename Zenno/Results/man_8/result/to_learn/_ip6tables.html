
<!--+++++++++++++++++++++++++++++++++++++++++++  0  +++++++++++++++++++++++++++++++++++++++++++--->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>Проект OpenNet: MAN ip6tables (8) Команды системного администрирования (FreeBSD и Linux)</title><meta name="KeyWords" content="man, manual, MAN, системное руководство, linux, FreeBSD, OpenBSD, Solaris, ядро, программы, системный вызов, ip6tables"><meta name="viewport" content="width=device-width, initial-scale=1"></head>


<body link="#0000FF" vlink="#000080" text="#000000" bgcolor="#E3E4D0" alink="#FF00FF">
<link rel="stylesheet" href="/opennet4.css" type="text/css">
<!--htdig_noindex-->
<form method="get" action="https://www.opennet.ru/search.shtml">
<aside>
<div style="width: 100%; text-align: right; font-size: 70%; background: #E9EAD6; margin-bottom:-10px;">
Профиль: <b><a href="/~" rel="nofollow" title="/~ - сводная страница участника"><u>Аноним</u></a></b> (<a href="https://www.opennet.ru/cgi-bin/openforum/vsluhboard.cgi?az=login">вход</a> | <a href="https://www.opennet.ru/cgi-bin/openforum/vsluhboard.cgi?az=user_register">регистрация</a>)</div>

<table cellspacing="0" cellpadding="0" width="100%" border="0">
<tbody><tr>
<td style="background: #E9EAD6 url('/back.gif') repeat-x bottom left" valign="BOTTOM" bgcolor="#E9EAD6" width="300">
<a href="https://www.opennet.ru/"><img src="/opennet2.gif" alt="The OpenNET Project" height="60" width="249" border="0"></a><br>
</td>
<td style="background: #E9EAD6 url('/back.gif') repeat-x bottom left" bgcolor="#E9EAD6" align="CENTER" width="100">

</td><td style="background: #E9EAD6 url('/back.gif') repeat-x bottom left;padding-bottom:10px;" bgcolor="#E9EAD6" align="CENTER" width="50%">
<table width="100%" border="0">
<tbody><tr>
<td width="22%">
 <a href="https://www.opennet.ru/opennews/" class="h"><b>НОВОСТИ</b></a> (<a href="https://www.opennet.ru/news/opennet.shtml" class="h">+</a>)
</td><td width="18%%">
  <a href="https://www.opennet.ru/mp/" class="h"><b>КОНТЕНТ</b></a>
</td><td width="14%">
  <a href="http://wiki.opennet.ru" class="h"><b>WIKI</b></a>
</td><td width="14%">
   <a href="https://www.opennet.ru/man.shtml" class="h"><b>MAN'ы</b></a>
</td><td width="16%">
   <a href="https://www.opennet.ru/forum/" class="h"><b>ФОРУМ</b></a>
</td><td width="16%">
<a href="https://www.opennet.ru/search.shtml" class="h" onmouseover="document.getElementById('form12').style.display='block';">Поиск</a>&nbsp;(<a href="https://www.opennet.ru/keywords/" class="h">теги</a>)
<input id="form12" style="display: none;" size="10" name="words" value="" title="для поиска в google наберите &quot;g фраза&quot;" type="text">
</td></tr>
</tbody></table>

</td><td style="background: #E9EAD6 url('/back.gif') repeat-x bottom left;padding-bottom:5px;" bgcolor="#E9EAD6" align="right" width="20%">

<a href="https://www.opennet.ru/opennews/opennews_all_utf.rss"><img src="/img/rss.png" alt="RSS" title="RSS" height="16" width="16" border="0"></a>&nbsp;<a href="https://twitter.com/opennetru"><img src="/twitter.png" alt="twitter" title="Twitter" height="16" width="16" border="0"></a>&nbsp;<a href="https://vk.com/opennet"><img src="/img/vkontakte.gif" title="ВКонтакте" height="16" width="16" border="0"></a>&nbsp;<a href="https://zen.yandex.ru/opennet"><img src="/img/zen.gif" title="Yandex Zen" height="16" width="16" border="0"></a>&nbsp;<a href="https://www.facebook.com/OpenNet.News/"><img src="/img/facebook.gif" title="Facebook" height="16" width="16" border="0"></a>&nbsp;<a href="https://telegram.space/opennet_ru"><img src="/img/telegram2.png" title="Telegram" height="16" width="16" border="0"></a>
</td></tr></tbody></table>
</aside>

<style>
    .hdr_mobile {
	text-align: center; 
	display: none;
	margin: 0px;
	padding: 0px;
    }
</style>
<div class="hdr_mobile">
<div style="margin-left: auto; margin-right: auto; width: 100%; height: 70px; border:1px solid #b0b190; min-width: 360px; max-width: 600px; background: #E9EAD6 url('/back.gif') repeat-x bottom left;">
<div style="float:left; width: 249px; height: 60px; margin-top: 10px;">
<a href="https://www.opennet.ru"><img src="/opennet2_lite.gif" style="height: 60px; width: 249px; border: 1px;" alt="The OpenNET Project / Index page"></a>
</div>
<div style="float: left; text-align: center; height: 70px; width: 331px; padding: 5px; margin-left: 10px;">
<br><small>[ <a href="/opennews/">новости</a>&nbsp;/<a href="/opennews/?full_lines=15&amp;lines=15&amp;mid_lines=00">+++</a> | <a href="/forum/">форум</a> | <a href="http://wiki.opennet.ru">wiki</a> | <a href="/keywords/">теги</a>
| <a href="tg://resolve?domain=opennet_ru"><img src="/img/telegram2.png" title="Telegram" style="margin-bottom: -4px;" height="16" width="16" border="0"></a>
]</small>
</div>
</div>
</div>
<div style="clear: both;"></div>


<div style="float: left; width: 279; text-align: left;padding-right: 60px;" id="adv">
</div>
<div style="padding-top: 0px;position:absolute;left:50%;margin-left:-235px;width:470px;" id="adv2">
</div>
<div style="width: 279;float: right;" id="adv3">
</div>
<div style="clear: both;"></div>
<br>
</form>
<!--/htdig_noindex-->

<center><h3><font color="#000088">Интерактивная система просмотра системных руководств (man-ов)</font></h3></center>
<form method="GET" action="/man.shtml"> 
<table cellspacing="0" cellpadding="1" bgcolor="#B0B190" align="center" width="600" border="0">
<tbody><tr>
<td valign="TOP">

<table cellspacing="0" cellpadding="0" bgcolor="#E9EAD6" align="center" width="100%" border="0">
<tbody><tr><td>&nbsp;<font color="#555555">Тема</font></td><td><font color="#555555">Набор</font></td><td><font color="#555555">Категория</font></td><td>&nbsp;</td></tr>
<tr><td>

&nbsp;<input size="20" name="topic" value="ip6tables" type="text"></td><td><select name="russian">
<option value="4">Solaris man
</option><option value="1">FreeBSD man
</option><option value="3">Разные man
</option><option value="0" selected="">Русские man
</option><option value="2">Linux man
</option><option value="5">POSIX man
</option></select></td>
<td><select size="1" name="category">
	  <option value="" selected="">All
	  </option><option value="1">1
	  </option><option value="2">2
	  </option><option value="3">3
	  </option><option value="4">4
	  </option><option value="5">5
	  </option><option value="6">6
	  </option><option value="7">7
	  </option><option value="8">8
	  </option><option value="9">9
</option></select></td>

<td><input name="submit" value="Показать man" type="submit"></td></tr>
<script async="" src="https://www.google-analytics.com/analytics.js"></script><script language="JavaScript" src="/print.js"></script>
<tr><td colspan="4" align="left">&nbsp;[<a href="/man.shtml">Cписок руководств</a> | <a href="#" onclick="pr('none');">Печать</a>]</td></tr>
</tbody></table>
</td></tr></tbody></table>
</form>
<h3></h3><font size="+2">ip6tables (8)</font><hr><li>&gt;&gt; <a href="/man.shtml?topic=ip6tables&amp;category=8&amp;russian=0"><u>ip6tables</u></a> (8) <font color="#555555"> ( Русские man: Команды системного администрирования )</font></li><li> <a href="/man.shtml?topic=ip6tables&amp;category=8&amp;russian=2"><u>ip6tables</u></a> (8) <font color="#555555"> ( Linux man: Команды системного администрирования )</font></li>


<a name="lbAB">&nbsp;</a>
<h2>ИМЯ</h2>

iptables - инструмент администрирования фильтра пакетов IPv6
<a name="lbAC">&nbsp;</a>
<h2>ОБЗОР</h2>

<b>ip6tables [-t таблица] -[AD] </b>цепочка описание-правил [опции]

<br>

<b>iptables [-t таблица] -I </b>цепочка [номер-правила] описание-правил [опции]

<br>

<b>ip6tables [-t таблица] -R </b>цепочка номер-правила описание-правил [опции]

<br>

<b>ip6tables [-t таблица] -D </b>цепочка номер-правила [опции]

<br>

<b>ip6tables [-t таблица] -[LFZ] </b>[цепочка] [опции]

<br>

<b>ip6tables [-t таблица] -N </b>цепочка

<br>

<b>ip6tables [-t таблица] -X </b>[цепочка]

<br>

<b>ip6tables [-t таблица] -P </b>цепочка цель [опции]

<br>

<b>ip6tables [-t таблица] -E </b>старое-имя-цепочки новое-имя-цепочки

<a name="lbAD">&nbsp;</a>
<h2>ОПИСАНИЕ</h2>

<b>ip6tables</b>

используется для установки, настройки и исследования таблиц
правил фильтрации IPv6-пакетов в ядре Linux.
<p>
Каждая таблица содержит несколько предопределённых цепочек и
может содержать цепочки, определённые пользователем. 
Каждая цепочка - это список правил, которые могут воздействовать на множества
пакетов.
Каждое правило определяет, какие действие произвести с пакетами, на которые оно действует.
Эти действия называются целью, целью может быть и переход на другую (определённую пользователем) цепочку в этой же таблице.
</p><p>
<a name="lbAE">&nbsp;</a>
</p><h2>ЦЕЛИ</h2>

Правило брандмауэра (межсетевого экрана) определяет критерии для пакета и цели.
Если пакет не попадает под действие правила, тестируется следующее правило в цепочке;
если попадает, - тестируется правило указанное в цели,
которая может быть именем новой цепочки или одно из специальных целей:
<i>ACCEPT</i>,

<i>DROP</i>,

<i>QUEUE</i>

или
<i>RETURN</i>.

<p>

<i>ACCEPT </i>

означает принять (пропустить далее) пакет
<i>DROP</i>

означает проигнорировать (отбросить) пакет.
<i>QUEUE</i>

означает передать пакет в адресное пространство пользователя
(получение пакета пользовательским процессом зависит
от обработчика очереди; в ядрах 2.4.x
и 2.6.x до 2.6.13 использовался обработчик
<b>ip_queue;</b>

в ядрах начиная с 2.6.14 появился дополнительный обработчик 
<b>nfnetlink_queue;</b>

в этом случае пакеты с целью QUEUE отправляются очереди номер 0;
см. также цель
<b>NFQUEUE</b>

ниже).
<i>RETURN</i>

означает остановить применение правил этой цепочки
и передать пакет следующему правилу предыдущей (вызывающей) цепочки.
Если достигается конец встроенной (предопределённой) цепочки или в ней 
к пакету применяется правило с целью 
<i>RETURN,</i>

то окончательное действие над пакетом (цель) определяется стратегией (политикой)
цепочки.
<a name="lbAF">&nbsp;</a>
</p><h2>ТАБЛИЦЫ</h2>

Существует две независимых таблицы
(какие именно таблицы присутствуют в данный момент --
зависит от конфигурации ядра и наличия его модулей), поскольку NAT ещё не
реализована.
<dl compact="">
<dt><b>-t, --table </b><i>таблица</i>

</dt><dd>
Задаёт таблицу, к которой будет применена команда.
Если ядро скомпилировано с автоматической загрузкой модулей,
то, при необходимости, будет загружен модуль, соответствующий таблице.
Итак, таблицы:
<dl compact=""><dt></dt><dd>
<dl compact="">
<dt><b>filter</b>:

</dt><dd>
Таблица используемая по-умолчанию (если опция -t не задана).
Эта таблица содержит предопределённые цепочки
<b>INPUT</b>

(для входящих пакетов - направленных данному компьютеру),
<b>FORWARD</b>

(для проходящих пакетов) и 
<b>OUTPUT</b>

(для исходящих пакетов - сгенерированных в локальной системе). 
</dd><dt><b>mangle</b>:

</dt><dd>
Эта таблица используется для специальных изменений пакетов.
Она содержала две предопределённые цепочки в ядрах до версии 2.4.17: 
<b>PREROUTING</b>

(для изменения входящих пакетов до их перенаправления-маршрутизации) и
<b>OUTPUT</b>

(для изменения локально сгенерированных пакетов перед их маршрутизацией).
Начиная с ядер версии 2.4.18, включены ещё три другие предопределённые цепочки: 
<b>INPUT</b>

(для изменения входящих пакетов),
<b>FORWARD</b>

(для изменения проходящих пакетов) и 
<b>POSTROUTING</b>

(для изменения исходящих пакетов).
</dd><dt><b>raw</b>:

</dt><dd>
Используется преимущественно для создания исключений в слежении за соединениями
совместно с целью NOTRACK. Для неё в netfilter сделаны специальные 
вставки имеющие высший приоритет и поэтому вызываемые до nf_conntrack
и всех других таблиц. В таблице имеются следующие предопределённые цепочки:
<b>PREROUTING</b>

(для пакетов приходящих из сетевых интерфейсов)
<b>OUTPUT</b>

(для пакетов генерируемых локальными процессами)
</dd></dl>
</dd></dl>

</dd></dl>
<a name="lbAG">&nbsp;</a>
<h2>ОПЦИИ</h2>

Опции для 
<b>ip6tables</b>

могут быть разделены на несколько групп.
<a name="lbAH">&nbsp;</a>
<h3>КОМАНДЫ</h3>

Эти опции определяют действие, выполняемое в данном сеансе работы программы.
В командной строке может быть указана только одна из этих опций,
если противоположное явно не указано в описании.
Длинные команды можно сокращать до первых букв,
но их должно быть достаточно, чтобы программа могла однозначно идентифицировать
команду.
<dl compact="">
<dt><b>-A, --append </b><i>цепочка определение-правила</i>

</dt><dd>
Добавить одно или несколько правил в конец указанной цепочки.
Если имя источника и/или стока (назначения) соответствует нескольким адресам,
правило будет добавлено для всех возможных комбинаций адресов.
</dd><dt><b>-D, --delete </b><i>цепочка определение-правила</i>

</dt><dd>

</dd><dt><b>-D, --delete </b><i>цепочка номер-правила</i>

</dt><dd>
Удалить одно или несколько правил из указанной цепочки.
Существует две версии этой команды: правило может быть указано через его номер в
цепочке (счёт первого правила начинается с 1) или через соответствие правилу.
</dd><dt><b>-I, --insert </b><i>цепочка</i> [<i>номер-правила</i>]

</dt><dd>
<i>определение-правила</i>"
В указанной цепочке вставить одно или более правил в позицию, заданную номером.
Так, если указан номер 1, правило или правила будут вставлены в начало цепочки.
Это подразумеваемая позиция, если номер не указан.
</dd><dt><b>-R, --replace </b><i>цепочка номер-правила определение-правила</i>

</dt><dd>
Заменить правило в указанной цепочке. Если имена источника и/или стока
соответствуют нескольким адресам,
команда не будет выполнена с сообщением об ошибке. Правила нумеруются с 1.
</dd><dt><b>-L, --list </b>[<i>цепочка</i>]

</dt><dd>
Показать все правила в выбранной цепочке.
Если цепочка не указана, то команда применяется ко всем цепочкам.
Как и всякая другая команда ip6tables, она воздействует на указанную таблицу
(filter, если таблица не указана), к примеру следующая команда выводит список
правил таблицы mangle:
<pre> ip6tables -t mangle -n -L
</pre>

Обратите внимание на опцию
<b>-n</b>

которая часто используется для отключения (медленного) определения имён DNS.
Также можно указать опцию -Z
<b>-Z</b>

(zero), в этом случае автоматически произойдёт перечисление правил цепочки и
обнуление её счётчиков.
Вид результата зависит от других аргументов.
Самый детальный результат может быть получен так:
<pre> ip6tables -L -v
</pre>

</dd><dt><b>-F, --flush </b>[<i>цепочка</i>]

</dt><dd>
Сбросить выбранную цепочку (все цепочки в таблице, если ни одна не указана).
Это эквивалентно удалению по одному всех правил.
</dd><dt><b>-Z, --zero </b>[<i>цепочка</i>]

</dt><dd>
Обнулить счётчики количества пакетов и байтов во всех или указанной цепочке.
Можно также указать 
<b>-L, --list</b>

чтобы отобразить значения счётчиков непосредственно перед их обнулением (см.
выше).
</dd><dt><b>-N, --new-chain </b><i>цепочка</i>

</dt><dd>
Создать новую, определённую пользователем цепочку с заданным именем.
В момент создания цепочки не должно быть уже существующих целей с указанным
именем.
</dd><dt><b>-X, --delete-chain </b>[<i>цепочка</i>]

</dt><dd>
Удалить цепочку, определённую пользователем.
При этом не должно быть ссылок на удаляемую цепочку.
Если такие ссылки есть, необходимо сначала удалить или изменить правила,
ссылающиеся на удаляемую цепочку.
Если цепочка не указана, из таблицы будут удалены все цепочки кроме встроенных.
</dd><dt><b>-P, --policy </b><i>цепочка цель</i>

</dt><dd>
Определить стратегию для цепочки.
Допустимые цели описаны в разделе 
<b>ЦЕЛИ</b>

настоящего документа.
Стратегия может быть задана только для встроенных цепочек и не может быть задана
для цепочек определённых пользователем.
</dd><dt><b>-E, --rename-chain </b><i>старое-имя новое-имя</i>

</dt><dd>
Переименовать цепочку, определённую пользователем.
Эта команда не изменяет структуру таблицы и используется только в косметических
целях.
</dd><dt><b>-h</b>

</dt><dd>
Подсказка. Выдаёт очень короткое описание синтаксиса команд.
</dd></dl>
<a name="lbAI">&nbsp;</a>
<h3>ПАРАМЕТРЫ</h3>

Следующие параметры предназначены для формирования правил
(используются в командах add, delete, insert, replace и append).
<dl compact="">
<dt><b>-p, --protocol </b>[!] <i>протокол</i>

</dt><dd>
Сетевой протокол применяемого правила или проверяемого пакета.
Допустимые значения:
<i>tcp</i>,

<i>udp</i>,

<i>icmpv6</i>,

<i>esp</i>,

<i>all</i>.

Также протоколы можно указывать в виде числа (соответствующего одному из
перечисленных или иному протоколу).
Названия протоколов также можно брать из файла /etc/protocols.
Расширения заголовков IPv6, кроме
<i>esp</i>,

запрещены.
<i>esp</i>

и 
<i>ipv6-nonext</i>

можно использовать на ядрах 2.6.11 и выше.
Знак "!" перед названием протокола инвертирует результат теста.
Число 0 эквивалентно 
<i>all</i>.

Значение
<i>all</i>

соответствует всем протоколами и используется если данный параметр опущен.
</dd><dt><b>-s, --source </b>[!] <i>адрес</i>[/<i>маска</i>]

</dt><dd>
Адрес источника.
<i>Адресом</i>

может быть имя хоста (не рекомендуем указывать имена хостов, разрешаемые через
запросы к удалённым DNS),
сетевой IPv6-адрес (либо диапазон адресов - при указании маски), 
или одиночный IPv6-адрес (сетевые имена не поддерживаются на данный момент).
<i>Маской</i>

может быть сетевая маска или число, соответствующее количеству определяющих
разрядов в сетевой маске.
Например, маска 
<i>64</i>

эквивалентна 
<i>ffff:ffff:ffff:ffff:0000:0000:0000:0000</i>.

Знак "!" перед спецификацией адреса инвертирует результат теста.
Опция --src
<b>--src</b>

является псевдонимом данного параметра.
</dd><dt><b>-d, --destination </b>[!] <i>адрес</i>[/<i>маска</i>]

</dt><dd>
Адрес цели. Синтаксис аналогичен синтаксису параметра 
<b>-s</b>

Опция 
<b>--dst</b>

является псевдонимом данного параметра.
</dd><dt><b>-j, --jump </b><i>цель</i>

</dt><dd>
Определяет цель правила; т.е., что делать, когда пакет попадает под условия
правила.
Целью может быть цепочка определённая пользователем (отличная от цепочки
правила),
одна из встроенных целей, определяющая окончательное действие над пакетом,
или расширение (см. раздел 
<b>РАСШИРЕНИЯ </b>

далее). Если эта опция не задана в правиле, то правило не будет применяться, но
счётчик количества применений правила будет увеличен.
</dd><dt><b>-i, --in-interface </b>[!] <i>имя</i>

</dt><dd>
Имя интерфейса, через который должен быть получен обрабатываемый пакет
(только для пакетов входящих в цепочки 
<b>INPUT</b>,

и 
<b>PREROUTING ).</b>

Использование аргумента "!" перед именем интерфейса инвертирует результат теста.
Если имя интерфейса оканчивается на "+", то это означает любой интерфейс, имя
которого начинается с указанного имени.
Если эта опция опущена, при обработке пакета интерфейс, с которого он был
получен, не учитывается.
</dd><dt><b>-o, --out-interface </b>[!] <i>имя</i>

</dt><dd>
Имя интерфейса, через который отправляется обрабатываемый пакет
(только для пакетов входящих в цепочки 
<b>FORWARD</b>,

<b>OUTPUT</b>

и 
<b>POSTROUTING ).</b>

Использование аргумента "!" перед именем интерфейса инвертирует результат теста.
Если имя интерфейса оканчивается на "+", то это означает любой интерфейс, имя
которого начинается с указанного имени.
Если эта опция опущена, при обработке пакета интерфейс, с которого он был
получен, не учитывается.
</dd><dt>
</dt><dd>

фрагментам фрагментированного пакета.


номера портов или тип ICMP.

первому фрагменту или к нефрагментированному пакету.

<b>-c, --set-counters  число-пакетов число-байт</b>

Позволяет инициализировать в правиле счётчики пакетов и байтов (при выполнении
операций
<b>INSERT,</b>

<b>APPEND,</b>

<b>REPLACE ).</b>

</dd></dl>
<a name="lbAJ">&nbsp;</a>
<h3>ПРОЧИЕ ОПЦИИ</h3>

Имеются следующие дополнительные опции:
<dl compact="">
<dt><b>-v, --verbose</b>

</dt><dd>
Увеличить подробность сообщений.
При указании её с командой list будет выводиться имя интерфейса,
параметры правил и маски TOS.
Также выводятся счётчики ("K", "M", "G" соответствуют множителям
1 000, 1 000 000 и 1 000 000 000; см.
<b>-x ).</b>

Если ключ используется с командами --append, --insert, --delete или --replace,
то будет выведен подробный отчёт о произведенной операции.
</dd><dt><b>-n, --numeric</b>

</dt><dd>
Выводить IP-адреса и номера портов в числовом виде предотвращая попытки
преобразовать их в символические имена.
</dd><dt><b>-x, --exact</b>

</dt><dd>
Для всех чисел в выходных данных выводить их точные значения без округления
и без использования множителей K, M, G.
Этот ключ используется только с командой 
<b>-L</b>

и не применим с другими командами.
</dd><dt><b>--line-numbers</b>

</dt><dd>
Режим вывода номеров строк при отображении списка правил командой --list.
Номер строки соответствует позиции правила в цепочке.
</dd><dt><b>--modprobe=команда</b>

</dt><dd>
Команда загрузки модулей ядра (при добавлении правил в цепочку).
Может использоваться в случае, когда модули ядра находится вне стандартного пути
поиска.
</dd></dl>
<a name="lbAK">&nbsp;</a>
<h2>РАСШИРЕНИЯ МЕХАНИЗМА ТЕСТИРОВАНИЯ</h2>

Возможности тестирования пакетов расширяются через модули.
Последние загружаются либо автоматически при указании
<b>-p</b>

/
<b>--protocol ,</b>

либо явно при указании имени модуля через
<b>-m</b>

/
<b>--match .</b>

После загрузки модуля становятся доступными дополнительные опции командной
строки в зависимости от модуля.
Справку по новым ключам можно получить с помощью ключа
<b>-h</b>

/
<b>--help .</b>

Допустимо указание нескольких модулей.
Результаты тестирования, выдаваемые модулем, обычно можно инвертировать, указав 
<b>!</b>

перед его именем.
В базовую поставку входят следующие модули.

<a name="lbAL">&nbsp;</a>
<h3>ah</h3>

Этот модуль тестирует по параметрам аутентификационного заголовка пакетов IPsec.
<dl compact="">
<dt><b>--ahspi </b>[!] <i>spi</i>[:<i>spi</i>]

</dt><dd>
Последовательный периферийный интерфейс (SPI).
</dd><dt><b>--ahlen </b>[!] <i>размер</i>

</dt><dd>
Общий размер заголовка в октетах (байтах).
</dd><dt><b>--ahres</b>

</dt><dd>
Пропускать пакеты если зарезервированное поле заполнено нулями.
</dd></dl>
<a name="lbAM">&nbsp;</a>
<h3>condition</h3>

Результат теста совпадает со значением в соответствующем файле /proc - 0 или 1.
<dl compact="">
<dt><b>--condition </b>[!] <i>имя-файла</i>

</dt><dd>
Выдать результат теста из /proc/net/ip6t_condition/имя-файла.
</dd></dl>
<a name="lbAN">&nbsp;</a>
<h3>dst</h3>

Фильтрует пакеты по параметрам заголовка "Destination Options"
<dl compact="">
<dt><b>--dst-len </b>[!] <i>размер</i>

</dt><dd>
Общий размер заголовка в октетах.
</dd><dt><b>--dst-opts </b><i>тип</i>[:<i>размер</i>][,<i>тип</i>[:<i>размер</i>]...]

</dt><dd>
Номер опции и размер данных в октетах.
</dd></dl>
<a name="lbAO">&nbsp;</a>
<h3>esp</h3>

Служит для проверки значений SPI в заголовках ESP пакетов IPSec.
<dl compact="">
<dt><b>--espspi </b>[!] <i>spi</i>[:<i>spi</i>]

</dt><dd>
</dd></dl>
<a name="lbAP">&nbsp;</a>
<h3>eui64</h3>

Фильтрует по компоненту EUI-64 адреса IPv6 настроенного автоматически без
сохранения состояния.
Модуль производит сравнение EUI-64 полученного из исходного MAC-адреса
Ehternet-фрейма с младшими 64 разрядами IPv6-адреса источника.
Разряд "Universal/Local" не учитывается.
Модуль не пропускает другие фреймы на уровне канала связи
и может использоваться только в цепочках
<b>PREROUTING</b>,

<b>INPUT,</b>

<b>FORWARD</b>.

<a name="lbAQ">&nbsp;</a>
<h3>frag</h3>

Фильтрует по параметрам заголовка "Fragment".
<dl compact="">
<dt><b>--fragid </b>[!] <i>идентификатор</i>[:<i>идентификатор</i>]

</dt><dd>
Пропускать пакеты с идентификатором равным указанному или входящему в указанный
диапазон.
</dd><dt><b>--fraglen </b>[!] <i>размер</i>

</dt><dd>
Недействительно для ядер 2.6.10 и выше.
Размер заголовка Fragment фиксирован и ключ не имеет смысла.
</dd><dt><b>--fragres </b>

</dt><dd>
Пропускать пакеты, если зарезервированное поле заполнено нулями.
</dd><dt><b>--fragfirst </b>

</dt><dd>
Пропускать при первом фрагменте.
</dd><dt><b>[--fragmore]</b>

</dt><dd>
Пропускать если фрагментов несколько.
</dd><dt><b>[--fraglast]</b>

</dt><dd>
Пропускать при последнем фрагменте.
</dd></dl>
<a name="lbAR">&nbsp;</a>
<h3>fuzzy</h3>

Результат теста зависит от скорости доставки пакетов по методу FLC (Fuzzy Logic
Controller):
пока скорость доставки пакетов не достигает нижнего порога, условие никогда не
будет выполняться; 
при скорости в диапазоне между нижним и верхним порогами частота выполнения
условий будет расти пропорционально скорости доставки пакетов;
после превышения верхнего порога скорости частота выполнения условий достигнет
максимального значения.
<dl compact="">
<dt><b>--lower-limit </b><i>скорость</i>

</dt><dd>
Нижний порог (пакетов в секунду).
</dd><dt><b>--upper-limit </b><i>скорость</i>

</dt><dd>
Верхний порог (пакетов в секунду).
</dd></dl>
<a name="lbAS">&nbsp;</a>
<h3>hbh</h3>

Фильтрует по параметрам заголовка "Hop-by-Hop"
<dl compact="">
<dt><b>--hbh-len </b>[!] <i>размер</i>

</dt><dd>
Общий размер заголовка в октетах.
</dd><dt><b>--hbh-opts </b><i>тип</i>[:<i>размер</i>][,<i>тип</i>[:<i>размер</i>]...]

</dt><dd>
Номер опции и размер данных в октетах.
</dd></dl>
<a name="lbAT">&nbsp;</a>
<h3>hl</h3>

Фильтрует по полю "Hop Limit" заголовка IPv6.
<dl compact="">
<dt><b>--hl-eq </b>[!] <i>значение</i>

</dt><dd>
Пропускать пакеты с Hop Limit равным указанному <i>значению</i>.
</dd><dt><b>--hl-lt </b><i>значение</i>

</dt><dd>
Пропускать пакеты с Hop Limit меньше указанного <i>значения</i>.
</dd><dt><b>--hl-gt </b><i>значение</i>

</dt><dd>
Пропускать пакеты с Hop Limit больше указанного <i>значения</i>.
</dd></dl>
<a name="lbAU">&nbsp;</a>
<h3>icmp6</h3>

Это расширение загружается при указании `--protocol ipv6-icmp' или `--protocol
icmpv6'
<dl compact="">
<dt><b>--icmpv6-type </b>[!] <i>тип</i>[/<i>код</i>]|<i>имя-типа</i>

</dt><dd>
Тип ICMPv6 в виде числа или имени в соответствии с 
<pre> ip6tables -p ipv6-icmp -h
</pre>

</dd></dl>
<a name="lbAV">&nbsp;</a>
<h3>ipv6header</h3>

Фильтрует по заголовкам расширений IPv6 и/или заголовку более высокого уровня.
<dl compact="">
<dt><b>--header </b>[!] <i>заголовок</i>[,<i>заголовок</i>...]

</dt><dd>
Пропускать пакеты с набором заголовком точно равным указанному.
Заголовки встроенные в ESP не учитываются.
В качестве
<i>заголовка</i>

можно указывать:
<i>hop</i>|<i>hop-by-hop</i>

(заголовок "Hop-by-Hop Options"),
<i>dst</i>

(заголовок "Destination Options header"),
<i>route</i>

(заголовок "Routing header"),
<i>frag</i>

(заголовок "Fragment header"),
<i>auth</i>

(заголовок "Authentication header"),
<i>esp</i>

(заголовок "Encapsulating Security Payload"),
<i>none</i>

(заголовок "No Next header") - соответствующий 59 в поле Next Header заголовка
IPv6 или любого заголовка расширений IPv6, -
<i>proto</i>

- соответствующий любому заголовку протокола более верхнего уровня.
Возможно использование имён протоколов в соответствии с /etc/protocols 
и номеров. 255 соответствует 
<i>proto</i>.

</dd><dt><b>[--soft]</b>

</dt><dd>
Смягчить условия: пропускать пакет если в нём присутствуют _как минимум_
указанные
заголовки.
</dd></dl>
<a name="lbAW">&nbsp;</a>
<h3>length</h3>

Позволяет проверять размеры пакетов (точно или по диапазону).
Заголовок IPv6 не считается.
<dl compact="">
<dt><b>--length </b>[!] <i>размер</i>[:<i>размер</i>]

</dt><dd>
</dd></dl>
<a name="lbAX">&nbsp;</a>
<h3>limit</h3>

Этот модуль выдаёт положительный результат с фиксированной частотой.
Правило использующее это расширение будет выполняться до момента достижения
лимита
(и наоборот, если указан "!").
Может использоваться вместе с целью
<b>LOG</b>

для получения ограниченного протоколирования.
<dl compact="">
<dt><b>--limit </b><i>частота</i>

</dt><dd>
Максимальная средняя частота положительных результатов.
После числа можно указывать единицы:
`/second', `/minute', `/hour', `/day'; значение по умолчанию - 
3/час.
</dd><dt><b>--limit-burst </b><i>number</i>

</dt><dd>
Ограничение на исходное число пропускаемых пакетов:
это число увеличивается на единицу каждый раз когда ограничение на частоту
положительных результатов не достигается.
Это происходит столько раз, сколько указано в данном параметре.
Значение по умолчанию - 5.
</dd></dl>
<a name="lbAY">&nbsp;</a>
<h3>mac</h3>

<dl compact="">
<dt><b>--mac-source </b>[!] <i>адрес</i>

</dt><dd>
Выполнять тестирование по MAC-адресу отправителя.
Адрес должен указываться в форме XX:XX:XX:XX:XX:XX.
Использование данного условия имеет смысл только при получении пакетов от
устройства Ethernet, проходящих одну из цепочек
<b>PREROUTING</b>,

<b>FORWARD</b>

и
<b>INPUT .</b>

</dd></dl>
<a name="lbAZ">&nbsp;</a>
<h3>mark</h3>

Тестирует по полю mark. Это специальное поле, которое существует только в
области памяти ядра и связывается с конкретным пакетом.
(для установки этого поля используется цель
<b>MARK ,</b>

описанная ниже).
<dl compact="">
<dt><b>--mark </b><i>число</i>[/<i>маска</i>]

</dt><dd>
Пропускать пакеты с указанной отметкой (представляющей собой беззнаковое целое)
Если указана <i>маска</i>, то перед сравнением она накладывается на указанное
значение (логическое И).
</dd></dl>
<a name="lbBA">&nbsp;</a>
<h3>multiport</h3>

Позволяет указывать в тексте правила несколько (до 15) портов и диапазонов
портов.
Диапазон портов (порт:порт) считается за два порта (в отношении ограничения в
15).
Используется только вместе с 
<b>-p tcp</b>

или
<b>-p udp</b>.

<dl compact="">
<dt><b>--source-ports </b><i>[!] порт</i>[,<i>порт</i>[,<i>порт:порт</i>...]]

</dt><dd>
Пропускать пакеты с исходным портом равным одному из указанных.
Краткая форма ключа -
<b>--sports .</b>

</dd><dt><b>--destination-ports </b><i>[!] порт</i>[,<i>порт</i>[,<i>порт:порт</i>...]]

</dt><dd>
Пропускать пакеты с портом назначения равным одному из указанных.
Краткая форма ключа -
<b>--dports .</b>

</dd><dt><b>--ports </b><i>[!] порт</i>[,<i>порт</i>[,<i>порт:порт</i>...]]

</dt><dd>
Пропускать пакеты с одинаковыми исходным и портом назначения и равными одному из
указанных.
</dd></dl>
<a name="lbBB">&nbsp;</a>
<h3>nth</h3>

Пропускает каждый `n'-ый пакет
<dl compact="">
<dt><b>--every </b><i>n</i>

</dt><dd>
Пропускать каждый n-ый пакет.
</dd><dt><b>[</b><i>--counter </i><b>номер</b><i>]</i>

</dt><dd>
Использовать внутренний счётчик с указанным номером. Значение по умолчанию -
`0'.
</dd><dt><b>[</b><i>--start </i><b>число</b><i>]</i>

</dt><dd>
Начальное значение счётчика (вместо стандартного `0').
Обычно между `0' и `n'-1.
</dd><dt><b>[</b><i>--packet </i><b>k</b><i>]</i>

</dt><dd>
Пропускать k-ый пакет из набора n пакетов. Соответственно, значение должно быть
между `0' и `n'-1.
</dd></dl>
<a name="lbBC">&nbsp;</a>
<h3>owner</h3>

Позволяет фильтровать по параметрам "владельца" пакета.
Этот критерий можно использовать только в цепочке 
<b>OUTPUT ,</b>

но даже в этом случае могут попадаться пакеты без владельца
(например, ответы ISMP ping), и такие пакеты не будут пропускаться.
Имеет статус экспериментального.
<dl compact="">
<dt><b>--uid-owner </b><i>идентификатор-пользователя</i>

</dt><dd>
Пропускать пакеты генерируемые процессами работающими от указанного
пользователя.
</dd><dt><b>--gid-owner </b><i>идентификатор-группы</i>

</dt><dd>
Пропускать пакеты, генерируемые процессами работающими от пользователя входящего
в указанную группу.
</dd><dt><b>--pid-owner </b><i>идентификатор-процесса</i>

</dt><dd>
Пропускать пакеты, генерируемые процессом с указанным идентификатором.
</dd><dt><b>--sid-owner </b><i>идентификатор-сеанса</i>

</dt><dd>
Пропускать пакеты, генерируемые процессами в сеансе с указанным идентификатором.
</dd><dt>
</dt><dd>


соответствующую функцию)

<b>Примечание: фильтрация по pid, sid и команде не работает в SMP-системах</b>

</dd></dl>
<a name="lbBD">&nbsp;</a>
<h3>physdev</h3>

Позволяет организовывать фильтрацию по устройствам, используемым для связи двух
локальных сетей.
Это модуль является частью инфраструктуры для IP-брандмауэра "прозрачно"
связывающего сети. Имеет смысл использовать только с ядрами 2.5.44.
<dl compact="">
<dt><b>--physdev-in</b> [!] <i>имя</i>

</dt><dd>
Порт связи сетей, через который получен пакет (только для пакетов, проходящих
цепочки
<b>INPUT</b>,

<b>FORWARD</b>

и 
<b>PREROUTING ).</b>

Если имя интерфейса оканчивается на "+", то будут пропускаться пакеты со всех
интерфейсов, имя которых начинается 
с указанной последовательности.
Если пакет получен из устройства, которое не связывает локальные сети,
он не будет пропущен (если только не указано "!").
</dd><dt><b>--physdev-out</b> [!] <i>имя</i>

</dt><dd>
Порт связи сетей, через который пакет отправляется
(для пакетов проходящих цепочки 
<b>FORWARD</b>,

<b>OUTPUT</b>

и 
<b>POSTROUTING ).</b>

Если имя интерфейса оканчивается на "+", то будут пропускаться пакеты со всех
интерфейсов, имя которых начинается 
с указанной последовательности. Тестирование по порту вывода в цепочках
<b>OUTPUT</b>

<b>nat</b> и <b>mangle</b>

невозможно, зато в
<b>filter OUTPUT</b>

- возможно. Если пакет отправляется не через устройство связи двух сетей,
или если отправляющее устройство на данном этапе неизвестно,
то такой пакет не будет пропущен (если только не указан "!").
</dd><dt>[!] <b>--physdev-is-in</b>

</dt><dd>
Пропускать пакеты, полученные через интерфейс связи двух сетей.
</dd><dt>[!] <b>--physdev-is-out</b>

</dt><dd>
Пропускать пакеты, отправляемые через интерфейс связи двух сетей.
</dd><dt>[!] <b>--physdev-is-bridged</b>

</dt><dd>
Пропускать пакеты для которых не выполняется маршрутизация (т.к. они проходят
через "мост" между сетями)
Имеет смысл только в цепочках FORWARD и POSTROUTING.
</dd></dl>
<a name="lbBE">&nbsp;</a>
<h3>policy</h3>

Позволяет фильтровать пакеты по стратегии обработки пакета IPsec.
<dl compact="">
<dt><b>--dir </b><i>in|out</i>

</dt><dd>
Стратегия по которой следует фильтровать: стратегии извлечения данных из
сообщения или включения (инкапсуляции) оных.
Вариант
<b>in</b>

допустим в цепочках
<b>PREROUTING, INPUT и FORWARD ,</b>

вариант
<b>out</b>

<br>&nbsp;-&nbsp;в&nbsp;цепочках
<b>POSTROUTING, OUTPUT и FORWARD .</b>

</dd><dt><b>--pol </b><i>none|ipsec</i>

</dt><dd>
Должен ли пакет подлежать обработке IPsec.
</dd><dt><b>--strict</b>

</dt><dd>
Пропускать пакеты с хотя бы одним правилом, соответствующим заданной стратегии
или обязательно со всеми.
</dd><dt><b>--reqid </b><i>id</i>

</dt><dd>
Пропускать пакеты с указанным идентификатором reqid правила стратегии.
Идентификатор указывается с помощью команды 
<b><a href="https://www.opennet.ru/cgi-bin/opennet/man.cgi?topic=setkey&amp;category=8">setkey</a>(8) ,</b>

в качестве уровня используется
<b>unique:id .</b>

</dd><dt><b>--spi </b><i>spi</i>

</dt><dd>
Фильтровать пакеты на основе последовательного периферийного интерфейса (SPI)
SA.
</dd><dt><b>--proto </b><i>ah|esp|ipcomp</i>

</dt><dd>
Фильтровать пакеты на основе протокола инкапсуляции.
</dd><dt><b>--mode </b><i>tunnel|transport</i>

</dt><dd>
Фильтровать пакеты на основе режима инкапсуляции.
</dd><dt><b>--tunnel-src </b><i>адрес[/маска]</i>

</dt><dd>
Пропускать пакеты с исходным адресом [пункта] режима tunnel SA, входящим в
указанный диапазон.
Имеет смысл только при --mode tunnel.
</dd><dt><b>--tunnel-dst </b><i>адрес[/маска]</i>

</dt><dd>
Пропускать пакеты с адресом назначения режима tunnel SA, входящим в указанный
диапазон.
Имеет смысл только при --mode tunnel.
</dd><dt><b>--next</b>

</dt><dd>
Начать следующий элемент в спецификации стратегии. 
Может указываться вместе с 
--strict
</dd></dl>
<a name="lbBF">&nbsp;</a>
<h3>random</h3>

Вероятностная фильтрация.
<dl compact="">
<dt><b>--average </b><i>доля</i>

</dt><dd>
Пропускать указанную часть пакетов (в процентах).
Значение по умолчанию - 50%.
</dd></dl>
<a name="lbBG">&nbsp;</a>
<h3>rt</h3>

Фильтрует по заголовку маршрутизации IPv6
<dl compact="">
<dt><b>--rt-type</b> [!] <i>тип</i>

</dt><dd>
Пропускать пакеты с указанными типом (указывается номер).
</dd><dt><b>--rt-segsleft</b> [!] <i>число</i>[:<i>число-макс</i>]

</dt><dd>
Пропускать пакеты со значением поля segments left (количество оставшихся
сегментов)
входящим в указанный диапазон или равным указанному.
</dd><dt><b>--rt-len</b> [!] <i>длина</i>

</dt><dd>
Пропускать пакеты указанного размера.
</dd><dt><b>--rt-0-res</b>

</dt><dd>
Пропускать также пакеты с резервным полем (тип 0)
</dd><dt><b>--rt-0-addrs</b> <i>адрес</i>[,<i>адрес</i>...]

</dt><dd>
Пропускать адреса с типом 0 (список).
</dd><dt><b>--rt-0-not-strict</b>

</dt><dd>
Список адресов с типом 0 не строгий.
</dd></dl>
<a name="lbBH">&nbsp;</a>
<h3>tcp</h3>

Это расширение загружается при указании `--protocol tcp'.
Становятся доступными следующие ключи:
<dl compact="">
<dt><b>--source-port </b>[!] <i>порт</i>[:<i>порт</i>]

</dt><dd>
Исходный порт (или диапазон портов), с которого должен быть отправлен пакет для
прохождения теста.
В качестве значения может указываться номер порта или название сетевой службы. 
Диапазон (включительно) портов указывается в формате
<i>первый-порт</i>:<i>последний-порт</i>.

Если опускается первый порт, т.е. когда критерий записывается как --source-port
:80,
то в качестве начала диапазона принимается число 0.
Если опускается максимальный порт, т.е. когда критерий записывается как
--source-port 22:,
то в качестве конца диапазона принимается число 65535.
Если первый порт больше последнего, они меняются местами.
Краткая форма ключа -
<b>--sport .</b>

</dd><dt><b>--destination-port </b>[!] <i>порт</i>[:<i>порт</i>]

</dt><dd>
Порт (или диапазон портов) назначения. Краткая форма ключа -
<b>--dport .</b>

</dd><dt><b>--tcp-flags </b>[!] <i>флаги</i> <i>comp</i>

</dt><dd>
Пропускать пакеты с указанным набором флагов TCP.
Первый аргумент - флаги (через запятую) которые нужно проверять,
второй - те флаги, которые должны быть установлены.
Возможные флаги:
<b>SYN ACK FIN RST URG PSH ALL NONE</b>.

Так, условию
<pre> ip6tables -A FORWARD -p tcp --tcp-flags SYN,ACK,FIN,RST SYN
</pre>

будут соответствовать пакеты с установленным флагом SYN, и снятыми флагами
ACK, FIN, RST.
</dd><dt><b>[!] --syn</b>

</dt><dd>
Пропускать пакеты TCP с установленным флагом SYN и снятыми ACK,RST.
Такие пакеты используются для запроса создания TCP-соединения;
очевидно, блокирование таких пакетов приведёт к невозможности 
создания входящих TCP-соединений.
Эквивалентно <b>--tcp-flags SYN,RST,ACK SYN</b>.
Указание "!" перед "--syn", смысл ключа инвертируется.
</dd><dt><b>--tcp-option </b>[!] <i>номер-опции</i>

</dt><dd>
Пропускать пакеты с установленной опцией TCP.
</dd></dl>
<a name="lbBI">&nbsp;</a>
<h3>udp</h3>

Это расширение загружается при указании `--protocol udp'.
Доступны следующие ключи:
<dl compact="">
<dt><b>--source-port </b>[!] <i>порт</i>[:<i>порт</i>]

</dt><dd>
Диапазон, в который должен входить исходный порт.
См. описание ключа 
<b>--source-port</b>

расширения TCP.
</dd><dt><b>--destination-port </b>[!] <i>port</i>[:<i>port</i>]

</dt><dd>
Диапазон, в который должен входить целевой порт.
См. описание ключа 
<b>--destination-port</b>

расширения TCP.
</dd></dl>
<a name="lbBJ">&nbsp;</a>
<h2>РАСШИРЕНИЯ МЕХАНИЗМА ОБРАБОТКИ</h2>

В ip6tables можно добавлять дополнительные цели: 
Далее описаны модули включенные в стандартную поставку.

<a name="lbBK">&nbsp;</a>
<h3>CONNMARK</h3>

Помечает соединения.
<dl compact="">
<dt><b>--set-mark метка[/маска]</b>

</dt><dd>
Метка соединения. Если указана маска, изменяются только биты, которые равны
единице в маске.
</dd><dt><b>--save-mark [--mask маска]</b>

</dt><dd>
Перенести метку пакета в соединение. Если указана маска, копируются только
биты, которые равны единице в маске.
</dd><dt><b>--restore-mark [--mask маска]</b>

</dt><dd>
Перенести метку соединения в пакет. 
Если указана маска, копируются только биты, которые равны единице в маске.
Допустимо только в таблице 
<b>mangle .</b>

</dd></dl>
<a name="lbBL">&nbsp;</a>
<h3>CONNSECMARK</h3>

Переносит метки механизма защиты из пакетов в соединения 
(если они ещё не имеют меток), и из соединений обратно в пакеты
(также если они ещё не имеют меток).
Обычно используется совместно с SECMARK, и только в таблице 
<b>mangle .</b>

<dl compact="">
<dt><b>--save</b>

</dt><dd>
Если пакет имеет метку, а соединение - нет, то перенести её в соединение.
</dd><dt><b>--restore</b>

</dt><dd>
Если соединение имеет метку, а пакет - нет, то перенести её в соединение.
<p>
</p></dd></dl>
<a name="lbBM">&nbsp;</a>
<h3>HL</h3>

Модифицирует поле Hop Limit ("ограничение на пересылку") заголовка IPv6.
Это поле выполняет аналогичные функции TTL в IPv4.
Изменение (особенно - увеличение) этого поля может быть опасным,
потому желательно избегать этого.
Используется в таблице 
<b>mangle .</b>

<dl compact="">
<dt><b>Никогда не изменяйте (особенно - не увеличивайте) значение для пакетов,</b>

</dt><dd>
покидающих локальную сеть.
</dd><dt><b>--hl-set </b><i>значение</i>

</dt><dd>
Установить новое значение Hop Limit.
</dd><dt><b>--hl-dec </b><i>значение</i>

</dt><dd>
Уменьшить значение Hop Limit на указанное число.
</dd><dt><b>--hl-inc </b><i>значение</i>

</dt><dd>
Увеличить значение Hop Limit на указанное число.
</dd></dl>
<a name="lbBN">&nbsp;</a>
<h3>LOG</h3>

Вносить в протокол ядра записи о пакетах (например, поля заголовка IPv6), для
которых указана данная цель.
Протокол ядра доступен по команде 
<i>dmesg .</i>

См.
<i><a href="https://www.opennet.ru/cgi-bin/opennet/man.cgi?topic=syslogd&amp;category=8">syslogd</a></i>(8)).

Обработка после этой цели продолжается.
Так, для внесения записей о блокируемых пакетах 
укажите два отдельных правила с одинаковыми условиями,
для первого укажите цель LOG, для второго - DROP (или REJECT).
<dl compact="">
<dt><b>--log-level </b><i>уровень</i>

</dt><dd>
Степень подробности (число, см. <i><a href="https://www.opennet.ru/cgi-bin/opennet/man.cgi?topic=syslog.conf&amp;category=5">syslog.conf</a></i>(5)).
</dd><dt><b>--log-prefix </b><i>префикс</i>

</dt><dd>
Префикс для выделения записей протокола среди других. До 29 символов.
</dd><dt><b>--log-tcp-sequence</b>

</dt><dd>
Протоколировать номера последовательностей (sequence numbers) TCP.
Если протокол доступен обычным пользователям, это отрицательно скажется на
защищённости системы.
</dd><dt><b>--log-tcp-options</b>

</dt><dd>
Вносить в протокол параметры заголовка TCP.
</dd><dt><b>--log-ip-options</b>

</dt><dd>
Вносить в протокол параметры заголовка IPv6.
</dd><dt><b>--log-uid</b>

</dt><dd>
Вносить в протокол идентификатор пользователя, которому принадлежит процесс,
сгенерировавший пакет.
</dd></dl>
<a name="lbBO">&nbsp;</a>
<h3>MARK</h3>

Используется для присвоения пакетам меток.
Может использоваться только в пределах таблицы
<b>mangle .</b>

Обычно используется вместе с iproute2.
<dl compact="">
<dt><b>--set-mark </b><i>значение</i>

</dt><dd>
Задать значение nfmark.



</dd></dl>
<a name="lbBP">&nbsp;</a>
<h3>NFQUEUE</h3>

Это расширение QUEUE. 
В отличие от QUEUE, позволяет помещать пакет в определённую очередь
идентифицируемую по 16-разрядному номеру.
<dl compact="">
<dt><b>--queue-num </b><i>номер</i>

</dt><dd>
Номер очереди QUEUE. Допустимые номера - от 0 до 65535.
По умолчанию - 0.
</dd><dt>Работает только с ядрами 2.6.14 и выше, т.к. требует поддержку</dt><dd>
<b>nfnetlink_queue.</b>

</dd></dl>
<a name="lbBQ">&nbsp;</a>
<h3>REJECT</h3>

Используется для отправки сообщения об ошибке на хост, от которого получен
исходный пакет,
в остальном эквивалентно 
<b>DROP ,</b>

обработка пакета останавливается на этой цели.
Может использоваться только в цепочках 
<b>INPUT</b>,

<b>FORWARD ,</b>

<b>OUTPUT ,</b>

а также в цепочках вложенных в них.
Следующий ключ определяет форму пакета с сообщением об ошибке:
<dl compact="">
<dt><b>--reject-with </b><i>тип</i>

</dt><dd>
Сообщение ICMP об ошибке.
Возможные значения:
<pre><b> icmp6-no-route</b>
<b> no-route</b>
<b> icmp6-adm-prohibited</b>
<b> adm-prohibited</b>
<b> icmp6-addr-unreachable</b>
<b> addr-unreach</b>
<b> icmp6-port-unreachable</b>
<b> port-unreach</b>
</pre>

По умолчанию отправляется <b>port-unreach</b>.
Для правил, которые фильтруют пакеты только принадлежащие протоколу TCP,
можно указывать
<b>tcp-reset :</b>

это приведёт к возврату пакетов TCP RST и полезно для блокирования тестов
<i>ident</i>

(113/tcp), выполняемых при отправке почты на недоступные узлы.
Использовать
<b>tcp-reset</b>

можно только с ядрами 2.6.14 и выше.
<p>
</p></dd></dl>
<a name="lbBR">&nbsp;</a>
<h3>ROUTE</h3>

Позволяет явно изменять логику маршрутизации сетевой подсистемы. Используется в
таблице
<b>mangle .</b>

<dl compact="">
<dt><b>--oif </b><i>интерфейс</i>

</dt><dd>
Направить пакет через указанный интерфейс.
</dd><dt><b>--gw </b><i>IPv6-адрес</i>

</dt><dd>
Направить пакет через указанный шлюз.
</dd><dt><b>--continue </b>

</dt><dd>
Не прекращать тестирование пакета в цепочке.
Недопустимо, если указан `--tee'.
</dd><dt><b>--tee </b>

</dt><dd>
Выполнять указанные действия над копией пакета,
не прекращать тестирование исходного пакета в цепочке.
Недопустимо, если указан ключ `--continue'.
</dd></dl>
<a name="lbBS">&nbsp;</a>
<h3>SECMARK</h3>

Устанавливает метки механизма защиты в пакетах.
Они используются подсистемами защиты наподобие SELinux.
Допустимо указание только в таблице
<b>mangle .</b>

<dl compact="">
<dt><b>--selctx </b><i>контекст-защиты</i>

</dt><dd>
</dd></dl>
<a name="lbBT">&nbsp;</a>
<h3>TRACE</h3>

Включает 
<b>трассировку пакетов </b>

соответствующих условию правила.
<a name="lbBU">&nbsp;</a>
<h2>ДИАГНОСТИКА</h2>

Разнообразные сообщения выводятся на стандартный вывод.
Код выхода в случае отсутствия ошибок - 0.
Если команде переданы недопустимые ключи, код выхода равен 2,
при остальных ошибках код выхода равен 1.
<a name="lbBV">&nbsp;</a>
<h2>ОШИБКИ</h2>

Работа счётчиков ненадёжна на sparc64.
<a name="lbBW">&nbsp;</a>
<h2>СОВМЕСТИМОСТЬ С IPCHAINS</h2>

Пакет
<b>iptables</b>

очень похож на ipchains, написанные Расти Расселом (Rusty Russell).
Основное различие состоит в том, что цепочки
<b>INPUT</b>

и
<b>OUTPUT</b>

не применяются для "проходящих" пакетов.
Потому каждый пакет проходит только через одну из цепочек
(кроме трафика кольцевого интерфейса loopback, проходящего через 
INPUT и OUTPUT).
<p>

Другое различие состоит в том, что
<b>-i</b>

относится с входному интерфейсу;
<b>-o</b>

- к выходному, и оба они доступны для пакетов 
в цепочке 
<b>FORWARD .</b>



дополнительные расширения.



Натурально, имеется много менее значительных изменений.
<a name="lbBX">&nbsp;</a>
</p><h2>СМ. ТАКЖЕ</h2>

<b><a href="https://www.opennet.ru/cgi-bin/opennet/man.cgi?topic=ip6tables-save&amp;category=8">ip6tables-save</a></b>(8),

<b><a href="https://www.opennet.ru/cgi-bin/opennet/man.cgi?topic=ip6tables-restore&amp;category=8">ip6tables-restore</a>(8),</b>

<b><a href="https://www.opennet.ru/cgi-bin/opennet/man.cgi?topic=iptables&amp;category=8">iptables</a></b>(8),

<b><a href="https://www.opennet.ru/cgi-bin/opennet/man.cgi?topic=iptables-save&amp;category=8">iptables-save</a></b>(8),

<b><a href="https://www.opennet.ru/cgi-bin/opennet/man.cgi?topic=iptables-restore&amp;category=8">iptables-restore</a></b>(8),

<b><a href="https://www.opennet.ru/cgi-bin/opennet/man.cgi?topic=libipq&amp;category=3">libipq</a></b>(3).


О фильтрации пакетов более подробно написано в packet-filtering-HOWTO,
о трансляции адресов - в NAT-HOWTO,
о нестандартных расширениях - в netfilter-extensions-HOWTO,
о программировании - в netfilter-hacking-HOWTO.
<br>

См.
<b><a href="http://www.netfilter.org/">http://www.netfilter.org/</a></b>

и
<b><a href="http://www.linuxshare.ru/docs/security/iptables/iptables-tutorial.html.">http://www.linuxshare.ru/docs/security/iptables/iptables-tutorial.html.</a></b>

<a name="lbBY">&nbsp;</a>
<h2>АВТОРЫ</h2>

Пакет iptables создал Расти Рассел (Rusty Russell), консультируясь с 
Майклом Ньюлингом (Michael Neuling) на ранних этапах.
<p>

Благодаря Марку Бушэ (Marc Boucher) был удалён код ipnatctl,
он был заменен более общей инфраструктурой селекции пакетов.
Им была реализована таблица mangle, фильтрация по владельцу,
метки и ещё много чего другого.
</p><p>

Джеймс Моррис (James Morris) реализовал цель TOS и фильтрацию по tos.
</p><p>

Джозеф Кадлецик (Jozsef Kadlecsik) реализовал цель REJECT.
</p><p>

Гаральд Уэльт (Harald Welte) реализовал цели ULOG и NFQUEUE,
libiptc, а также libipulog и цель+фильтр TTL.
</p><p>

</p><p>
Команду Netfilter Core Team составляют: Марк Бушэ (Marc Boucher),
Мартин Джозефсон (Martin Josefsson),
Джозеф Кадлецик (Jozsef Kadlecsik), 
Джеймс Моррис (James Morris),
Гаральд Уэльт (Harald Welte)
и Расти Рассел (Rusty Russell).
</p><p>

Настоящий документ создан Адрасом Киз-Жабо (Andras Kis-Szabo)
на основе страницы iptables для IPv4 написанной Херви Ейчинном (Herve Eychenne) &lt;<a href="mailto:rv@wallfire.org">rv@wallfire.org</a>&gt;.



</p><p>
<a name="lbBZ">&nbsp;</a>
</p><h2>ПЕРЕВОД</h2>

Николай Шафоростов &lt;<a href="mailto:shafff@ukr.net">shafff@ukr.net</a>&gt; 2007
<p>

</p><hr>
<a name="index">&nbsp;</a><h2>Index</h2>
<dl>
<dt><a href="#lbAB">ИМЯ</a></dt><dd>
</dd><dt><a href="#lbAC">ОБЗОР</a></dt><dd>
</dd><dt><a href="#lbAD">ОПИСАНИЕ</a></dt><dd>
</dd><dt><a href="#lbAE">ЦЕЛИ</a></dt><dd>
</dd><dt><a href="#lbAF">ТАБЛИЦЫ</a></dt><dd>
</dd><dt><a href="#lbAG">ОПЦИИ</a></dt><dd>
<dl>
<dt><a href="#lbAH">КОМАНДЫ</a></dt><dd>
</dd><dt><a href="#lbAI">ПАРАМЕТРЫ</a></dt><dd>
</dd><dt><a href="#lbAJ">ПРОЧИЕ ОПЦИИ</a></dt><dd>
</dd></dl>
</dd><dt><a href="#lbAK">РАСШИРЕНИЯ МЕХАНИЗМА ТЕСТИРОВАНИЯ</a></dt><dd>
<dl>
<dt><a href="#lbAL">ah</a></dt><dd>
</dd><dt><a href="#lbAM">condition</a></dt><dd>
</dd><dt><a href="#lbAN">dst</a></dt><dd>
</dd><dt><a href="#lbAO">esp</a></dt><dd>
</dd><dt><a href="#lbAP">eui64</a></dt><dd>
</dd><dt><a href="#lbAQ">frag</a></dt><dd>
</dd><dt><a href="#lbAR">fuzzy</a></dt><dd>
</dd><dt><a href="#lbAS">hbh</a></dt><dd>
</dd><dt><a href="#lbAT">hl</a></dt><dd>
</dd><dt><a href="#lbAU">icmp6</a></dt><dd>
</dd><dt><a href="#lbAV">ipv6header</a></dt><dd>
</dd><dt><a href="#lbAW">length</a></dt><dd>
</dd><dt><a href="#lbAX">limit</a></dt><dd>
</dd><dt><a href="#lbAY">mac</a></dt><dd>
</dd><dt><a href="#lbAZ">mark</a></dt><dd>
</dd><dt><a href="#lbBA">multiport</a></dt><dd>
</dd><dt><a href="#lbBB">nth</a></dt><dd>
</dd><dt><a href="#lbBC">owner</a></dt><dd>
</dd><dt><a href="#lbBD">physdev</a></dt><dd>
</dd><dt><a href="#lbBE">policy</a></dt><dd>
</dd><dt><a href="#lbBF">random</a></dt><dd>
</dd><dt><a href="#lbBG">rt</a></dt><dd>
</dd><dt><a href="#lbBH">tcp</a></dt><dd>
</dd><dt><a href="#lbBI">udp</a></dt><dd>
</dd></dl>
</dd><dt><a href="#lbBJ">РАСШИРЕНИЯ МЕХАНИЗМА ОБРАБОТКИ</a></dt><dd>
<dl>
<dt><a href="#lbBK">CONNMARK</a></dt><dd>
</dd><dt><a href="#lbBL">CONNSECMARK</a></dt><dd>
</dd><dt><a href="#lbBM">HL</a></dt><dd>
</dd><dt><a href="#lbBN">LOG</a></dt><dd>
</dd><dt><a href="#lbBO">MARK</a></dt><dd>
</dd><dt><a href="#lbBP">NFQUEUE</a></dt><dd>
</dd><dt><a href="#lbBQ">REJECT</a></dt><dd>
</dd><dt><a href="#lbBR">ROUTE</a></dt><dd>
</dd><dt><a href="#lbBS">SECMARK</a></dt><dd>
</dd><dt><a href="#lbBT">TRACE</a></dt><dd>
</dd></dl>
</dd><dt><a href="#lbBU">ДИАГНОСТИКА</a></dt><dd>
</dd><dt><a href="#lbBV">ОШИБКИ</a></dt><dd>
</dd><dt><a href="#lbBW">СОВМЕСТИМОСТЬ С IPCHAINS</a></dt><dd>
</dd><dt><a href="#lbBX">СМ. ТАКЖЕ</a></dt><dd>
</dd><dt><a href="#lbBY">АВТОРЫ</a></dt><dd>
</dd><dt><a href="#lbBZ">ПЕРЕВОД</a></dt><dd>
</dd></dl>
<hr>
<br>
<form method="get" action="/search.shtml">
<font size="-1">
<font color="#555555">Поиск по тексту MAN-ов:&nbsp;</font><input size="30" name="words" value="ip6tables" type="text">
<input name="restrict" value="/man" type="hidden">
<input value="Найти" type="submit">
</font>
<input name="method" value="and" type="hidden">
<input name="format" value="builtin-long" type="hidden">
<input name="sort" value="score" type="hidden">
</form>
<br>
<!--htdig_noindex-->
<noindex>
<br>


</noindex>
<!--/htdig_noindex-->


<!-- footer -->
<!--htdig_noindex-->
<br><br>
<div style="background-color: #E9EAD6; width:100%; height: 61px;">
<div style="margin-right: 20px; float:left; line-height: 61px; vertical-align: middle; margin-left: 10px; font-size: 120%;">
Спонсоры:
</div>
<div style="float:left; height: 60px;  line-height: 60px; margin-left: 20px;">
<a style="align: middle;" target="_blank" href="https://inferno.name/"><img src="/img/inferno2.png" alt="Inferno Solutions" height="57" width="200"></a>
</div>
<div style="float:right; height: 60px;  line-height: 60px;  margin-left: 15px;">
<a style="align: middle;" target="_blank" href="http://hoster.ru/?utm_source=site&amp;utm_medium=banner&amp;utm_campaign=opennet"><img src="/img/dh143x60t.png" alt="Hosting by Hoster.ru" height="60" width="143"></a>
</div>
<div style="float:right;  height: 60px;  line-height: 60px; vertical-align: middle;font-size: 120%;">
Хостинг:
</div>

</div>

<div style="clear: both;"></div>


<br>
<table class="ttxt" style="border-top: 3px solid #C9CaB6;">
<tbody><tr><td width="35%">
<a href="/cgi-bin/opennet/bookmark.cgi">Закладки на сайте</a><br>
<a href="/cgi-bin/opennet/bookmark.cgi?submit=add" target="blank_">Проследить за страницей</a>
</td>
<td align="RIGHT" width="65%">
Created&nbsp;1996-2021&nbsp;by <b><a href="/contact.shtml" title="email maxim.chirkov@gmail.com">Maxim&nbsp;Chirkov</a></b><br>
<a href="https://www.opennet.ru/add.shtml">Добавить</a>, <a href="https://www.opennet.ru/donate.shtml" style="color: #C00000;">Поддержать</a>, <a href="https://www.opennet.ru/banners2.shtml">Вебмастеру</a>
</td>
</tr>
</tbody></table>
<br><br>


<!--/htdig_noindex-->
<!-- end of footer -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-123449-1', 'auto');
    ga('send', 'pageview');
</script>




</body>
<!---------------------------------------------  0  ---------------------------------------------->
