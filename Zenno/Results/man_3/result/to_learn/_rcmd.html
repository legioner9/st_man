
<!--+++++++++++++++++++++++++++++++++++++++++++  0  +++++++++++++++++++++++++++++++++++++++++++--->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>Проект OpenNet: MAN rcmd (3) Библиотечные вызовы (FreeBSD и Linux)</title><meta name="KeyWords" content="man, manual, MAN, системное руководство, linux, FreeBSD, OpenBSD, Solaris, ядро, программы, системный вызов, rcmd"><meta name="viewport" content="width=device-width, initial-scale=1"></head>


<body link="#0000FF" vlink="#000080" text="#000000" bgcolor="#E3E4D0" alink="#FF00FF">
<link rel="stylesheet" href="/opennet4.css" type="text/css">
<!--htdig_noindex-->
<form method="get" action="https://www.opennet.ru/search.shtml">
<aside>
<div style="width: 100%; text-align: right; font-size: 70%; background: #E9EAD6; margin-bottom:-10px;">
Профиль: <b><a href="/~" rel="nofollow" title="/~ - сводная страница участника"><u>Аноним</u></a></b> (<a href="https://www.opennet.ru/cgi-bin/openforum/vsluhboard.cgi?az=login">вход</a> | <a href="https://www.opennet.ru/cgi-bin/openforum/vsluhboard.cgi?az=user_register">регистрация</a>)</div>

<table cellspacing="0" cellpadding="0" width="100%" border="0">
<tbody><tr>
<td style="background: #E9EAD6 url('/back.gif') repeat-x bottom left" valign="BOTTOM" bgcolor="#E9EAD6" width="300">
<a href="https://www.opennet.ru/"><img src="/opennet2.gif" alt="The OpenNET Project" height="60" width="249" border="0"></a><br>
</td>
<td style="background: #E9EAD6 url('/back.gif') repeat-x bottom left" bgcolor="#E9EAD6" align="CENTER" width="100">

</td><td style="background: #E9EAD6 url('/back.gif') repeat-x bottom left;padding-bottom:10px;" bgcolor="#E9EAD6" align="CENTER" width="50%">
<table width="100%" border="0">
<tbody><tr>
<td width="22%">
 <a href="https://www.opennet.ru/opennews/" class="h"><b>НОВОСТИ</b></a> (<a href="https://www.opennet.ru/news/opennet.shtml" class="h">+</a>)
</td><td width="18%%">
  <a href="https://www.opennet.ru/mp/" class="h"><b>КОНТЕНТ</b></a>
</td><td width="14%">
  <a href="http://wiki.opennet.ru" class="h"><b>WIKI</b></a>
</td><td width="14%">
   <a href="https://www.opennet.ru/man.shtml" class="h"><b>MAN'ы</b></a>
</td><td width="16%">
   <a href="https://www.opennet.ru/forum/" class="h"><b>ФОРУМ</b></a>
</td><td width="16%">
<a href="https://www.opennet.ru/search.shtml" class="h" onmouseover="document.getElementById('form12').style.display='block';">Поиск</a>&nbsp;(<a href="https://www.opennet.ru/keywords/" class="h">теги</a>)
<input id="form12" style="display: none;" size="10" name="words" value="" title="для поиска в google наберите &quot;g фраза&quot;" type="text">
</td></tr>
</tbody></table>

</td><td style="background: #E9EAD6 url('/back.gif') repeat-x bottom left;padding-bottom:5px;" bgcolor="#E9EAD6" align="right" width="20%">

<a href="https://www.opennet.ru/opennews/opennews_all_utf.rss"><img src="/img/rss.png" alt="RSS" title="RSS" height="16" width="16" border="0"></a>&nbsp;<a href="https://twitter.com/opennetru"><img src="/twitter.png" alt="twitter" title="Twitter" height="16" width="16" border="0"></a>&nbsp;<a href="https://vk.com/opennet"><img src="/img/vkontakte.gif" title="ВКонтакте" height="16" width="16" border="0"></a>&nbsp;<a href="https://zen.yandex.ru/opennet"><img src="/img/zen.gif" title="Yandex Zen" height="16" width="16" border="0"></a>&nbsp;<a href="https://www.facebook.com/OpenNet.News/"><img src="/img/facebook.gif" title="Facebook" height="16" width="16" border="0"></a>&nbsp;<a href="https://telegram.space/opennet_ru"><img src="/img/telegram2.png" title="Telegram" height="16" width="16" border="0"></a>
</td></tr></tbody></table>
</aside>

<style>
    .hdr_mobile {
	text-align: center; 
	display: none;
	margin: 0px;
	padding: 0px;
    }
</style>
<div class="hdr_mobile">
<div style="margin-left: auto; margin-right: auto; width: 100%; height: 70px; border:1px solid #b0b190; min-width: 360px; max-width: 600px; background: #E9EAD6 url('/back.gif') repeat-x bottom left;">
<div style="float:left; width: 249px; height: 60px; margin-top: 10px;">
<a href="https://www.opennet.ru"><img src="/opennet2_lite.gif" style="height: 60px; width: 249px; border: 1px;" alt="The OpenNET Project / Index page"></a>
</div>
<div style="float: left; text-align: center; height: 70px; width: 331px; padding: 5px; margin-left: 10px;">
<br><small>[ <a href="/opennews/">новости</a>&nbsp;/<a href="/opennews/?full_lines=15&amp;lines=15&amp;mid_lines=00">+++</a> | <a href="/forum/">форум</a> | <a href="http://wiki.opennet.ru">wiki</a> | <a href="/keywords/">теги</a>
| <a href="tg://resolve?domain=opennet_ru"><img src="/img/telegram2.png" title="Telegram" style="margin-bottom: -4px;" height="16" width="16" border="0"></a>
]</small>
</div>
</div>
</div>
<div style="clear: both;"></div>


<div style="float: left; width: 279; text-align: left;padding-right: 60px;" id="adv">
</div>
<div style="padding-top: 0px;position:absolute;left:50%;margin-left:-235px;width:470px;" id="adv2">
</div>
<div style="width: 279;float: right;" id="adv3">
</div>
<div style="clear: both;"></div>
<br>
</form>
<!--/htdig_noindex-->

<center><h3><font color="#000088">Интерактивная система просмотра системных руководств (man-ов)</font></h3></center>
<form method="GET" action="/man.shtml"> 
<table cellspacing="0" cellpadding="1" bgcolor="#B0B190" align="center" width="600" border="0">
<tbody><tr>
<td valign="TOP">

<table cellspacing="0" cellpadding="0" bgcolor="#E9EAD6" align="center" width="100%" border="0">
<tbody><tr><td>&nbsp;<font color="#555555">Тема</font></td><td><font color="#555555">Набор</font></td><td><font color="#555555">Категория</font></td><td>&nbsp;</td></tr>
<tr><td>

&nbsp;<input size="20" name="topic" value="rcmd" type="text"></td><td><select name="russian">
<option value="4">Solaris man
</option><option value="1">FreeBSD man
</option><option value="3">Разные man
</option><option value="0" selected="">Русские man
</option><option value="2">Linux man
</option><option value="5">POSIX man
</option></select></td>
<td><select size="1" name="category">
	  <option value="" selected="">All
	  </option><option value="1">1
	  </option><option value="2">2
	  </option><option value="3">3
	  </option><option value="4">4
	  </option><option value="5">5
	  </option><option value="6">6
	  </option><option value="7">7
	  </option><option value="8">8
	  </option><option value="9">9
</option></select></td>

<td><input name="submit" value="Показать man" type="submit"></td></tr>
<script async="" src="https://www.google-analytics.com/analytics.js"></script><script language="JavaScript" src="/print.js"></script>
<tr><td colspan="4" align="left">&nbsp;[<a href="/man.shtml">Cписок руководств</a> | <a href="#" onclick="pr('none');">Печать</a>]</td></tr>
</tbody></table>
</td></tr></tbody></table>
</form>
<h3></h3><font size="+2">rcmd (3)</font><hr><li> <a href="/man.shtml?topic=rcmd&amp;category=3&amp;russian=4"><u>rcmd</u></a> (3) <font color="#555555"> ( Solaris man: Библиотечные вызовы )</font></li><li> <a href="/man.shtml?topic=rcmd&amp;category=3&amp;russian=1"><u>rcmd</u></a> (3) <font color="#555555"> ( FreeBSD man: Библиотечные вызовы )</font></li><li>&gt;&gt; <a href="/man.shtml?topic=rcmd&amp;category=3&amp;russian=0"><u>rcmd</u></a> (3) <font color="#555555"> ( Русские man: Библиотечные вызовы )</font></li><li> <a href="/man.shtml?topic=rcmd&amp;category=3&amp;russian=2"><u>rcmd</u></a> (3) <font color="#555555"> ( Linux man: Библиотечные вызовы )</font></li><br>BSD mandoc<br>
BSD 4.2

<a name="lbAB">&nbsp;</a>
<h2>НАЗВАНИЕ</h2>

<b>rcmd</b>

 
<b>rresvport</b>

 
<b>iruserok</b>

 
<b>ruserok</b>

 - процедуры возврата потока на удаленную команду

<a name="lbAC">&nbsp;</a>
<h2>СИНТАКСИС</h2>

Fd #include &lt;<a href="file:/usr/include/unistd.h">unistd.h</a>&gt;

<b>int</b>
rcmd (char **ahost int inport const char *locuser const char *remuser const char *cmd int *fd2p);<br>

<b>int</b>
rresvport (int *port);<br>

<b>int</b>
iruserok (u_int32_t raddr int superuser const char *ruser const char *luser);<br>

<b>int</b>
ruserok (const char *rhost int superuser const char *ruser const char *luser);<br>

<a name="lbAD">&nbsp;</a>
<h2>ОПИСАНИЕ</h2>

Функции 
rcmd ();<br>

применяются суперпользователем для исполнения команд на
удаленной машине при помощи схемы аутентификации,
основанной на зарезервированных номерах портов.
Функция
rresvport ();<br>

возвращает описатель сокета с адресом в привилегированном
пространстве пользователя. Функции
iruserok ();<br>

и
ruserok ();<br>

используются серверами для аутентификации клиентов, запрашивающих сервис
rcmd (.);<br>

Все четыре функции существуют в одном файле и используются сервером
<a href="https://www.opennet.ru/cgi-bin/opennet/man.cgi?topic=rshd&amp;category=8">rshd</a>(8)


(среди прочих).
<p>

Функция
rcmd ();<br>

ищет хост
Fa *ahost ,

используя
<a href="https://www.opennet.ru/cgi-bin/opennet/man.cgi?topic=gethostbyname&amp;category=3">gethostbyname</a>(3)


и возвращая -1, если хост не существует. Иначе
Fa *ahost

устанавливается равным стандартному имени хоста, при этом
создается соединение с сервером на хорошо известном порту Интернет
Fa inport .

</p><p>

Если соединение успешно установлено, то
сокет в Интернет-домене типа
<b>SOCK_STREAM</b>

возвращается вызывающей программе
и передается удаленной команде как 
<i>stdin</i>

и
<i>stdout</i>

 
Если 
Fa fd2p

не равно нулю, то установится вспомогательный канал управления процессами,
а описатель его будет помещен в 
Fa *fd2p .

Управление процессами возвратит диагностический выход из команды
(устройства #2) в этом канале, а также примет байты в этот канал как номера сигналов
<b>UNIX </b>

для пересылки их группе процессов команды. Если
Fa fd2p

равно 0, то
<i>stderr</i>

(устройство #2 удаленного управления) будет работать аналогично
<i>stdout </i>

и для пересылки произвольных сигналов в удаленный процесс не будет создано
никаких привилегий, хотя Вы сможете привлечь к себе внимание, используя
данные "out-of-band".
</p><p>

Протокол подробно описан в
<a href="https://www.opennet.ru/cgi-bin/opennet/man.cgi?topic=rshd&amp;category=8">rshd</a>(8).


</p><p>

Функция
rresvport ();<br>

используется для получения сокета с привилегированным адресом,
"привязанным" к нему. Этот сокет подходит для его использования функцией
rcmd ();<br>

и некоторыми другими.  Привилегированные порты Интернет -
это порты с номерами от нуля до 1023-х. Только суперпользователь может
"привязать" адрес с таким номером к сокету.
</p><p>

Функции
iruserok ();<br>

и
ruserok ();<br>

берут соответственно IP-адрес или имя удаленного хоста,
два имени пользователя  и флаг, указывающий, является ли имя локального
пользователя именем суперпользователя.
Далее, если пользователь
<i>НЕ</i>

является суперпользователем, они проверяют файл
/etc/hosts.equiv

 
Если этот поиск не выполняется или выполнен неудачно, то проверяется
.rhosts

в домашнем каталоге пользователя (для получения информации о том,
разрешен ли данный сервис пользователю или нет).
</p><p>

Если этот файл не существует, не является простым файлом, если его владельцем
является не текущий пользователь или не суперпользователь
или если он недоступен для записи текущему пользователю,
проверка завершается появлением ошибки.
Если имя машины указано в файле
``hosts.equiv 

''

или если хост и имя пользователя для удаленного доступа найдены в файле
``.rhosts

''

 
то возвращается 0; иначе
iruserok ();<br>

и
ruserok ();<br>

возвращают -1.
Если имя локального домена (полученное от
<a href="https://www.opennet.ru/cgi-bin/opennet/man.cgi?topic=gethostname&amp;category=2">gethostname</a>(2))


является именем удаленного домена, то может указываться только имя машины.
</p><p>

Если IP-адрес удаленного хоста известен, то должно использоваться
iruserok ();<br>

вместо
ruserok (,);<br>

так как последнее не требует проверки DNS-сервера для домена удаленного хоста.
<a name="lbAE">&nbsp;</a>
</p><h2>ДИАГНОСТИКА</h2>

Функция
rcmd ();<br>

возвращает правильный номер описателя сокета при успешном завершении работы.
При ошибках возвращается -1 и выводится диагностическое сообщение об ошибке.
<p>

Функция
rresvport ();<br>

возвращает правильный связанный описатель сокета при успешном завершении работы.
При ошибках возвращается -1 и в глобальную переменную
<i>errno</i>

записывается код ошибки.
Код ошибки
<b>EAGAIN:</b>

при "переполнении" она означает: "Все сетевые порты заняты".
<a name="lbAF">&nbsp;</a>
</p><h2>СМ. ТАКЖЕ</h2>

<a href="https://www.opennet.ru/cgi-bin/opennet/man.cgi?topic=rlogin&amp;category=1">rlogin</a>(1),


<a href="https://www.opennet.ru/cgi-bin/opennet/man.cgi?topic=rsh&amp;category=1">rsh</a>(1),


<a href="https://www.opennet.ru/cgi-bin/opennet/man.cgi?topic=intro&amp;category=2">intro</a>(2),


<a href="https://www.opennet.ru/cgi-bin/opennet/man.cgi?topic=rexec&amp;category=3">rexec</a>(3),


<a href="https://www.opennet.ru/cgi-bin/opennet/man.cgi?topic=rexecd&amp;category=8">rexecd</a>(8),


<a href="https://www.opennet.ru/cgi-bin/opennet/man.cgi?topic=rlogind&amp;category=8">rlogind</a>(8),


<a href="https://www.opennet.ru/cgi-bin/opennet/man.cgi?topic=rshd&amp;category=8">rshd</a>(8)


<a name="lbAG">&nbsp;</a>
<h2>ПРИМЕЧАНИЯ ПО ИСТОРИИ</h2>

Эти функции появились в версии
BSD 4.2
 
<p>

</p><hr>
<a name="index">&nbsp;</a><h2>Index</h2>
<dl>
<dt><a href="#lbAB">НАЗВАНИЕ</a></dt><dd>
</dd><dt><a href="#lbAC">СИНТАКСИС</a></dt><dd>
</dd><dt><a href="#lbAD">ОПИСАНИЕ</a></dt><dd>
</dd><dt><a href="#lbAE">ДИАГНОСТИКА</a></dt><dd>
</dd><dt><a href="#lbAF">СМ. ТАКЖЕ</a></dt><dd>
</dd><dt><a href="#lbAG">ПРИМЕЧАНИЯ ПО ИСТОРИИ</a></dt><dd>
</dd></dl>
<hr>
<br>
<form method="get" action="/search.shtml">
<font size="-1">
<font color="#555555">Поиск по тексту MAN-ов:&nbsp;</font><input size="30" name="words" value="rcmd" type="text">
<input name="restrict" value="/man" type="hidden">
<input value="Найти" type="submit">
</font>
<input name="method" value="and" type="hidden">
<input name="format" value="builtin-long" type="hidden">
<input name="sort" value="score" type="hidden">
</form>
<br>
<!--htdig_noindex-->
<noindex>
<br>


</noindex>
<!--/htdig_noindex-->


<!-- footer -->
<!--htdig_noindex-->
<br><br>
<div style="background-color: #E9EAD6; width:100%; height: 61px;">
<div style="margin-right: 20px; float:left; line-height: 61px; vertical-align: middle; margin-left: 10px; font-size: 120%;">
Спонсоры:
</div>
<div style="float:left; height: 60px;  line-height: 60px; margin-left: 20px;">
<a style="align: middle;" target="_blank" href="https://inferno.name/"><img src="/img/inferno2.png" alt="Inferno Solutions" height="57" width="200"></a>
</div>
<div style="float:right; height: 60px;  line-height: 60px;  margin-left: 15px;">
<a style="align: middle;" target="_blank" href="http://hoster.ru/?utm_source=site&amp;utm_medium=banner&amp;utm_campaign=opennet"><img src="/img/dh143x60t.png" alt="Hosting by Hoster.ru" height="60" width="143"></a>
</div>
<div style="float:right;  height: 60px;  line-height: 60px; vertical-align: middle;font-size: 120%;">
Хостинг:
</div>

</div>

<div style="clear: both;"></div>


<br>
<table class="ttxt" style="border-top: 3px solid #C9CaB6;">
<tbody><tr><td width="35%">
<a href="/cgi-bin/opennet/bookmark.cgi">Закладки на сайте</a><br>
<a href="/cgi-bin/opennet/bookmark.cgi?submit=add" target="blank_">Проследить за страницей</a>
</td>
<td align="RIGHT" width="65%">
Created&nbsp;1996-2021&nbsp;by <b><a href="/contact.shtml" title="email maxim.chirkov@gmail.com">Maxim&nbsp;Chirkov</a></b><br>
<a href="https://www.opennet.ru/add.shtml">Добавить</a>, <a href="https://www.opennet.ru/donate.shtml" style="color: #C00000;">Поддержать</a>, <a href="https://www.opennet.ru/banners2.shtml">Вебмастеру</a>
</td>
</tr>
</tbody></table>
<br><br>


<!--/htdig_noindex-->
<!-- end of footer -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-123449-1', 'auto');
    ga('send', 'pageview');
</script>




</body>
<!---------------------------------------------  0  ---------------------------------------------->
